<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Shen Ao" />

<meta name="date" content="2021-12-17" />

<title>Homework to StatComp21010</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework to StatComp21010</h1>
<h4 class="author">Shen Ao</h4>
<h4 class="date">2021-12-17</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>All my homework answers about Statistical Computing class.</p>
</div>
<div id="title-a2101020210916" class="section level2">
<h2>title: “A—21010—2021—09—16”</h2>
</div>
<div id="question" class="section level1">
<h1>Question</h1>
<p>Use knitr to produce at least three examples(texts,figures,tables).</p>
</div>
<div id="answer" class="section level1">
<h1>Answer</h1>
<p>example one: random number generation from the Poisson Distribution</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">set.seed</span>(<span class="dv">1014</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>x&lt;-<span class="kw">rpois</span>(<span class="dv">108</span>,<span class="dt">lambda=</span><span class="dv">6</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>y&lt;-<span class="kw">matrix</span>(<span class="kw">rpois</span>(<span class="dv">12</span><span class="op">*</span><span class="dv">9</span>,<span class="dt">lambda=</span><span class="dv">6</span>),<span class="dt">nrow=</span><span class="dv">12</span>,<span class="dt">ncol=</span><span class="dv">9</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb1-4"><a href="#cb1-4"></a>x;y</span></code></pre></div>
<pre><code>##   [1]  3  8  6  4  1  6  6  5  7  8  9  4  2  5  5  4  5  3  5 11  5  7  7  4 12
##  [26]  7  2  6  7  7  2  4  5  7  6  5  7 10  4  4  7  6  7  7  3  8  8 12 11  5
##  [51]  6  5  4  6  6  8  4  7  3  5  8  4  6  5  6  4 10  6  6  4  6  5  2  6  5
##  [76]  2  5  6  9  5  6  6  4  5  6 10  5  4  7  2 14  3  6  8  7  4  6  8  2  6
## [101]  8  8  5  4  5  7  6  7</code></pre>
<pre><code>##       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
##  [1,]    6    8    7    9    1    9   13    6    5
##  [2,]    8    6    7    9    6    4   10    9    4
##  [3,]    5    8    3    4    4    7    9   10    6
##  [4,]    6    7    4    2    9    3   14    7    4
##  [5,]    9    2    6    4    9    8    7    4    7
##  [6,]    4    6    5    6    4    6   10   11    8
##  [7,]    9    6    8   13    7    4    5    7    9
##  [8,]    4    1   10    5    8    7    5    5    7
##  [9,]    7    3    9    3    9    3    6    4    7
## [10,]    4   10    5    5    9    8    3    9    8
## [11,]    5   16    5   10    4    2    3    9    4
## [12,]    4    2   10    4    8    5    9    5   12</code></pre>
<p><br />
example two: table of time series</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">ts</span>(<span class="kw">matrix</span>(<span class="kw">rpois</span>(<span class="dv">108</span>,<span class="dv">6</span>),<span class="dv">12</span>,<span class="dv">9</span>),<span class="dt">frequency=</span><span class="dv">12</span>,<span class="dt">start=</span><span class="kw">c</span>(<span class="dv">1958</span>,<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##          Series 1 Series 2 Series 3 Series 4 Series 5 Series 6 Series 7
## Jan 1958        6        7       11        7        6        8        8
## Feb 1958        8        9        1        7        6        3        6
## Mar 1958        8       12        7        5        3        6        9
## Apr 1958        8        4        5       11        5        8        2
## May 1958        5        7       10        5        4        5        3
## Jun 1958        3        5        7        2        7        6        3
## Jul 1958        3        2        7        6        7        4        7
## Aug 1958        7        7        8        4       10        2        5
## Sep 1958        6        6        6        3        4       11        3
## Oct 1958        7        5        4       10       11        4        3
## Nov 1958        5        9        6        8        5        8       10
## Dec 1958       11        6        5        8        7        9        4
##          Series 8 Series 9
## Jan 1958        7        6
## Feb 1958        4       11
## Mar 1958        6        5
## Apr 1958        8        4
## May 1958        3        8
## Jun 1958        4        2
## Jul 1958        5        8
## Aug 1958        1        4
## Sep 1958        9        2
## Oct 1958        5        8
## Nov 1958        8        8
## Dec 1958        7       11</code></pre>
<p><br />
example three: expression</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>x&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">10</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>y&lt;-<span class="kw">runif</span>(<span class="dv">10</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a>z&lt;-<span class="kw">rchisq</span>(<span class="dv">10</span>,<span class="dv">14</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a>exp1&lt;-<span class="kw">expression</span>(x<span class="op">/</span>(y<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="kw">exp</span>(z)))</span>
<span id="cb6-5"><a href="#cb6-5"></a>exp1</span></code></pre></div>
<pre><code>## expression(x/(y^2 + exp(z)))</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">eval</span>(exp1)</span></code></pre></div>
<pre><code>##  [1] 3.312498e-07 1.864428e-05 1.514529e-09 2.544191e-06 4.718561e-06
##  [6] 3.895018e-06 4.611205e-06 6.553828e-05 2.037329e-04 2.166255e-07</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">D</span>(exp1,<span class="st">&quot;x&quot;</span>);<span class="kw">D</span>(exp1,<span class="st">&quot;y&quot;</span>);<span class="kw">D</span>(exp1,<span class="st">&quot;z&quot;</span>)</span></code></pre></div>
<pre><code>## 1/(y^2 + exp(z))</code></pre>
<pre><code>## -(x * (2 * y)/(y^2 + exp(z))^2)</code></pre>
<pre><code>## -(x * exp(z)/(y^2 + exp(z))^2)</code></pre>
<p><br />
example four: graphic split</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>m&lt;-<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>,<span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="kw">layout</span>(m,<span class="dt">widths=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="dt">heights=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="kw">layout.show</span>(<span class="dv">16</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><br />
example five:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>x=<span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">0.01</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">plot</span>(x,<span class="kw">exp</span>(((<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>x<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">15</span>,<span class="dv">15</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">main=</span><span class="st">&quot;标准正态图 &quot;</span>,  </span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="title-a2101020210923" class="section level2">
<h2>title: “A—21010—2021—09—23”</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 3.4,3.11,and 3.20(pages 94-96,Statistical Computing with R).</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>3.4: Devolop an algorithm to generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution: u&lt;-runif(n); y&lt;-<span class="math inline">\(-2ln(u)\)</span>; x&lt;-<span class="math inline">\(\sigma*sqrt(y)\)</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">set.seed</span>(<span class="dv">1014</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>n&lt;-<span class="fl">1e5</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb16-4"><a href="#cb16-4"></a>y&lt;-<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(u)</span>
<span id="cb16-5"><a href="#cb16-5"></a>x1&lt;-<span class="kw">sqrt</span>(y);x2&lt;-<span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(y);x3&lt;-<span class="dv">5</span><span class="op">*</span><span class="kw">sqrt</span>(y)  </span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">##Generate Rayleigh(sigma) samples for several choices of sigma&gt;0</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="kw">hist</span>(x1,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x1)<span class="op">==</span>x1<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x1<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)))</span>
<span id="cb16-8"><a href="#cb16-8"></a>m1&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="fl">0.1</span>)</span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="kw">lines</span>(m1,m1<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>m1<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>),<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">hist</span>(x2,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x2)<span class="op">==</span>(x2<span class="op">/</span><span class="dv">9</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x2<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">18</span>)))</span>
<span id="cb17-2"><a href="#cb17-2"></a>m2&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="fl">0.1</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="kw">lines</span>(m2,(m2<span class="op">/</span><span class="dv">9</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>m2<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">18</span>),<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">hist</span>(x3,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x3)<span class="op">==</span>(x3<span class="op">/</span><span class="dv">25</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x3<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">50</span>)))</span>
<span id="cb18-2"><a href="#cb18-2"></a>m3&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="fl">0.1</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="kw">lines</span>(m3,(m3<span class="op">/</span><span class="dv">25</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>m3<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">50</span>),<span class="dt">col=</span><span class="st">&quot;darkred&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co">## check that the mode of the generated samples is close to the theoretical mode sigma(check the histogram)</span></span></code></pre></div>
<p><br />
3.11:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">set.seed</span>(<span class="dv">1014</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a>n&lt;-<span class="dv">1000</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>X1&lt;-<span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a>X2&lt;-<span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">3</span>,<span class="dt">sd=</span><span class="dv">1</span>)</span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co">## Generate a random sample of size 1000 from a normal location mixture.</span></span>
<span id="cb20-6"><a href="#cb20-6"></a>Z1&lt;-<span class="fl">0.75</span><span class="op">*</span>X1<span class="op">+</span>(<span class="dv">1</span><span class="fl">-0.75</span>)<span class="op">*</span>X2</span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="kw">hist</span>(Z1,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(Z1)<span class="op">==</span><span class="fl">0.75</span><span class="op">*</span>X1<span class="fl">+0.25</span><span class="op">*</span>X2))</span>
<span id="cb20-8"><a href="#cb20-8"></a>x&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dt">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="kw">lines</span>(x,<span class="kw">dnorm</span>(x,<span class="fl">0.75</span>,<span class="fl">0.625</span>),<span class="dt">col=</span><span class="st">&quot;darkblue&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co">## Graph the histogram of the sample with density superimposed,for p1=0.75.</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>p1&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</span>
<span id="cb21-3"><a href="#cb21-3"></a>Z2&lt;-p1<span class="op">*</span>X1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>p1)<span class="op">*</span>X2</span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="kw">hist</span>(Z2)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co">## The components of the mixture have N(0,1) and N(3,1) distributions with mixing probabilities p1 and p2=1-p1.</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>Z3&lt;-<span class="fl">0.5</span><span class="op">*</span>X1<span class="fl">+0.5</span><span class="op">*</span>X2;Z4&lt;-<span class="fl">0.3</span><span class="op">*</span>X1<span class="fl">+0.7</span><span class="op">*</span>X2;Z5&lt;-<span class="fl">0.1</span><span class="op">*</span>X1<span class="fl">+0.9</span><span class="op">*</span>X2</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="kw">hist</span>(Z3);<span class="kw">hist</span>(Z4);<span class="kw">hist</span>(Z5)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co">## Repeat with different values for p1 and observe whether the empirical distribution of the mixture appears to be bimodal.</span></span></code></pre></div>
<p>Make a conjecture : p1=0.5,then Z=0.5<em>X1+0.5</em>X2 is bimodal.</p>
<p><br />
3.20: Write a program to simulate a compound Poisson(lambda)-Gauss process(Y has a Gamma distribution).</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">set.seed</span>(<span class="dv">1014</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a>f&lt;-<span class="cf">function</span>(n,t,lambda){</span>
<span id="cb24-3"><a href="#cb24-3"></a>  Nt&lt;-<span class="kw">rpois</span>(n,<span class="dt">lambda =</span> lambda<span class="op">*</span>t)</span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="kw">return</span>(Nt)}</span>
<span id="cb24-5"><a href="#cb24-5"></a>Xt&lt;-<span class="kw">numeric</span>()</span>
<span id="cb24-6"><a href="#cb24-6"></a>g&lt;-<span class="cf">function</span>(alpha, beta){</span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(N)){</span>
<span id="cb24-8"><a href="#cb24-8"></a>Xt[i]&lt;-<span class="kw">sum</span>(<span class="kw">rgamma</span>(N[i],<span class="dt">shape =</span> alpha, <span class="dt">scale=</span> <span class="dv">1</span><span class="op">/</span>beta))}</span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="kw">return</span>(Xt)}</span>
<span id="cb24-10"><a href="#cb24-10"></a>lambda&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dt">by=</span><span class="dv">1</span>)</span>
<span id="cb24-11"><a href="#cb24-11"></a>alpha&lt;-<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dt">length.out =</span> <span class="dv">10</span>,<span class="dt">by=</span><span class="dv">2</span>)</span>
<span id="cb24-12"><a href="#cb24-12"></a>beta&lt;-<span class="kw">seq</span>(<span class="dv">3</span>,<span class="dv">30</span>,<span class="dt">by=</span><span class="dv">3</span>)</span>
<span id="cb24-13"><a href="#cb24-13"></a>D&lt;-<span class="kw">data.frame</span>()</span>
<span id="cb24-14"><a href="#cb24-14"></a>E_X&lt;-<span class="kw">numeric</span>()</span>
<span id="cb24-15"><a href="#cb24-15"></a>Var_X&lt;-<span class="kw">numeric</span>()</span>
<span id="cb24-16"><a href="#cb24-16"></a>lambda.t.E_Y&lt;-<span class="kw">numeric</span>()</span>
<span id="cb24-17"><a href="#cb24-17"></a>Theoretical_Var&lt;-<span class="kw">numeric</span>()</span>
<span id="cb24-18"><a href="#cb24-18"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</span>
<span id="cb24-19"><a href="#cb24-19"></a>N&lt;-<span class="kw">f</span>(<span class="fl">1e4</span>,<span class="dv">10</span>,lambda[i])</span>
<span id="cb24-20"><a href="#cb24-20"></a>X&lt;-<span class="kw">g</span>(alpha[i],beta[i])</span>
<span id="cb24-21"><a href="#cb24-21"></a>E_X[i]&lt;-<span class="kw">mean</span>(X)</span>
<span id="cb24-22"><a href="#cb24-22"></a>Var_X[i]&lt;-(<span class="dv">1000-1</span>)<span class="op">*</span><span class="kw">var</span>(X)<span class="op">/</span><span class="dv">1000</span>  </span>
<span id="cb24-23"><a href="#cb24-23"></a>lambda.t.E_Y[i]&lt;-lambda[i]<span class="op">*</span><span class="dv">10</span><span class="op">*</span>alpha[i]<span class="op">/</span>beta[i] <span class="co">## theoretical mean :E[X(t)]=lambda*t*E[Yi]</span></span>
<span id="cb24-24"><a href="#cb24-24"></a>Theoretical_Var[i]&lt;-(lambda[i]<span class="op">*</span><span class="dv">10</span><span class="op">*</span>alpha[i]<span class="op">*</span>(alpha[i]<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(beta[i])<span class="op">^</span><span class="dv">2</span>)}</span>
<span id="cb24-25"><a href="#cb24-25"></a><span class="co">## theoretical variance  :Var[X(t)]=lambda*t*E[(Ti)^2]</span></span>
<span id="cb24-26"><a href="#cb24-26"></a>D&lt;-<span class="kw">data.frame</span>(lambda,alpha,beta,E_X,Var_X,lambda.t.E_Y,Theoretical_Var)</span>
<span id="cb24-27"><a href="#cb24-27"></a><span class="co">## putting differeent values of lambda ,alpha ,beta in f() and g() we can simulate compound Poisson process(lambda)-Gauss process(Y has a Gamma distribution).</span></span>
<span id="cb24-28"><a href="#cb24-28"></a>D</span></code></pre></div>
<pre><code>##    lambda alpha beta       E_X     Var_X lambda.t.E_Y Theoretical_Var
## 1       1     2    3  6.707144  6.592793     6.666667        6.666667
## 2       2     4    6 13.298360 11.044054    13.333333       11.111111
## 3       3     6    9 20.015809 15.669404    20.000000       15.555556
## 4       4     8   12 26.702117 20.245124    26.666667       20.000000
## 5       5    10   15 33.359443 25.474247    33.333333       24.444444
## 6       6    12   18 40.003413 28.836416    40.000000       28.888889
## 7       7    14   21 46.710009 33.014524    46.666667       33.333333
## 8       8    16   24 53.459442 37.031968    53.333333       37.777778
## 9       9    18   27 60.001101 42.718366    60.000000       42.222222
## 10     10    20   30 66.604108 46.940818    66.666667       46.666667</code></pre>
<p>The estimation of the mean and the variance of X(10) for several choices of the parameters(lambda,alpha,beta) is close to the theoretical values.</p>
</div>
<div id="a-21010-2021-09-30" class="section level2">
<h2>“A-21010-2021-09-30”</h2>
</div>
<div id="exercises-5.45.95.13and-5.14-pages-149-151statistical-computating-with-r." class="section level2">
<h2>Exercises 5.4,5.9,5.13,and 5.14 (pages 149-151,Statistical Computating with R).</h2>
</div>
<div id="question-5.4" class="section level2">
<h2>Question 5.4</h2>
<p>Write a function to cmpute a Monte Carlo estimate of the Beta(3,3)cdf,and use the function to estimate F(x) for x=0.1,0.2,…,0.9.Compare the estimates with the values returned by the pbeta function in R.</p>
</div>
<div id="answer-5.4" class="section level2">
<h2>Answer 5.4</h2>
<p>:The Beta(3,3) density is <span class="math display">\[
f(x)=\frac{1}{B(3,3)}[x^(3-1)][(1-x)^(3-1)]=30x^2(1-x)^2,0&lt;x&lt;1
\]</span></p>
<p>The Beta(3,3) cumulative distribution function is <span class="math display">\[
F(x)=\int_{0}^xf(t)dt=\int_{0}^x30t^2(1-t)^2dt
\]</span></p>
<p>make variable replacement:let t=xy <span class="math display">\[
F(x)=\int_{0}^{1}30(xy)^2(1-xy)^2xdy=E_Y[30x^3Y^2(1-xY)^2]
\]</span> where the random variable Y has the Uniform(0,1) distribution.</p>
<p>Generate iid Uniform(0,1) random numbers<span class="math inline">\(u_1,u_2,...,u_m\)</span>,and compute <span class="math display">\[
\hat{\theta}=1/m\sum_{i=1}^{m}30x^3u_i^2(1-xu_i)^2
\]</span></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">set.seed</span>(<span class="dv">1014</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>n&lt;-<span class="fl">1e6</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>f&lt;-<span class="cf">function</span>(x)</span>
<span id="cb26-4"><a href="#cb26-4"></a>{</span>
<span id="cb26-5"><a href="#cb26-5"></a>s=<span class="dv">0</span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</span>
<span id="cb26-7"><a href="#cb26-7"></a>{</span>
<span id="cb26-8"><a href="#cb26-8"></a>y=<span class="kw">rbeta</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="cf">if</span>(y<span class="op">&lt;=</span>x)</span>
<span id="cb26-10"><a href="#cb26-10"></a>s=s<span class="op">+</span><span class="dv">1</span>  </span>
<span id="cb26-11"><a href="#cb26-11"></a>}</span>
<span id="cb26-12"><a href="#cb26-12"></a>n_est<span class="op">&lt;</span>s<span class="op">/</span>n</span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="kw">return</span>(<span class="kw">c</span>(n_est,<span class="kw">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)))</span>
<span id="cb26-14"><a href="#cb26-14"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">set.seed</span>(<span class="dv">1014</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>x&lt;-<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="dt">length=</span><span class="dv">9</span>)</span>
<span id="cb27-3"><a href="#cb27-3"></a>m&lt;-<span class="fl">1e6</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>u&lt;-<span class="kw">runif</span>(m)</span>
<span id="cb27-5"><a href="#cb27-5"></a>cdf&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(x))</span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x))</span>
<span id="cb27-7"><a href="#cb27-7"></a> { g&lt;-<span class="dv">30</span><span class="op">*</span>(x[i]<span class="op">^</span><span class="dv">5</span>)<span class="op">*</span>(u<span class="op">^</span><span class="dv">4</span>)<span class="op">-</span><span class="dv">60</span><span class="op">*</span>(x[i]<span class="op">^</span><span class="dv">4</span>)<span class="op">*</span>(u<span class="op">^</span><span class="dv">3</span>)<span class="op">+</span><span class="dv">30</span><span class="op">*</span>(x[i]<span class="op">^</span><span class="dv">3</span>)<span class="op">*</span>(u<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb27-8"><a href="#cb27-8"></a>  cdf[i]&lt;-<span class="kw">mean</span>(g)</span>
<span id="cb27-9"><a href="#cb27-9"></a>}</span>
<span id="cb27-10"><a href="#cb27-10"></a>p.value&lt;-<span class="kw">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">rbind</span>(x,cdf,p.value),<span class="dv">5</span>))</span></code></pre></div>
<pre><code>##            [,1]    [,2]    [,3]    [,4]    [,5]    [,6]    [,7]    [,8]    [,9]
## x       0.10000 0.20000 0.30000 0.40000 0.50000 0.60000 0.70000 0.80000 0.90000
## cdf     0.00856 0.05795 0.16317 0.31761 0.50026 0.68291 0.83734 0.94253 0.99189
## p.value 0.00856 0.05792 0.16308 0.31744 0.50000 0.68256 0.83692 0.94208 0.99144</code></pre>
<p>We find that the figures are very close for m=100000 replications.</p>
</div>
<div id="question-5.9" class="section level2">
<h2>Question 5.9</h2>
<p>The Rayleigh denstity[156,(18.76)] is <span class="math display">\[
f(x) = \frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)}, \quad x\ge 0, \sigma&gt;0.
\]</span></p>
<p>Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution,using antithetic variables.What is the percent reduction in variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1,X_2\)</span>?</p>
</div>
<div id="answer-5.9" class="section level2">
<h2>Answer 5.9</h2>
<p>:The Rayleigh density is <span class="math display">\[
f(x) = \frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)}, \quad x\ge 0, \sigma&gt;0.
\]</span></p>
<p>The Rayleigh cumulative distribution function is <span class="math display">\[
F(x)=\int_{0}^x f(t)d t = \int_{0}^x\frac{t}{\sigma^2}e^{-t^2/(2\sigma^2)}dt
\]</span></p>
<p>make variable replacement:let t=xy <span class="math display">\[
F(x)=\int_{0}^{1}\frac{xy}{\sigma^2}e^{-(xy)^2/(2\sigma^2)}xdy=E_Y[1/(\sigma^2)x^2Ye^{-(xY)^2/(2\sigma^2)}]
\]</span> where the random variable Y has the Uniform(0,1) distribution.</p>
<p>Generate random numbers <span class="math inline">\(u_1,u_2,...,u_\frac{m}{2}\)</span>~Uniform(0,1) and compute half of the replicates using <span class="math display">\[
Y_j=\frac{u_jx^2}{\sigma^2}e^{-\frac{(xu_j)^2}{2\sigma^2}},j=1,2,...,\frac{m}{2}\\
Y_j&#39;=\frac{(1-u_j)x^2}{\sigma^2}e^{-\frac{[x(1-u_j)]^2}{2\sigma^2}},j=1,2,...,\frac{m}{2}
\]</span> The antithetic variable estimator is <span class="math display">\[
\hat{\theta}=\frac{1}{m}\sum_{j=1}^{m/2}(Y_j+Y_j&#39;)=\frac{1}{m}\sum_{j=1}^{m/2}(\frac{u_jx^2}{\sigma^2}e^{-\frac{(xu_j)^2}{2\sigma^2}}+\frac{(1-u_j)x^2}{\sigma^2}e^{-\frac{[x(1-u_j)]^2}{2\sigma^2}})
\]</span></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>MC.Phi&lt;-<span class="cf">function</span>(x,<span class="dt">R=</span><span class="fl">1e6</span>,<span class="dt">antithetic=</span><span class="ot">TRUE</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>{</span>
<span id="cb29-3"><a href="#cb29-3"></a>  u&lt;-<span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb29-4"><a href="#cb29-4"></a>  sigma&lt;-<span class="dv">1</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>  <span class="cf">if</span>(<span class="op">!</span>antithetic)</span>
<span id="cb29-6"><a href="#cb29-6"></a>    v&lt;-<span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb29-7"><a href="#cb29-7"></a>  <span class="cf">else</span></span>
<span id="cb29-8"><a href="#cb29-8"></a>    v&lt;-<span class="dv">1</span><span class="op">-</span>u</span>
<span id="cb29-9"><a href="#cb29-9"></a>  u&lt;-<span class="kw">c</span>(u,v)</span>
<span id="cb29-10"><a href="#cb29-10"></a>  cdf&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(x))</span>
<span id="cb29-11"><a href="#cb29-11"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x))</span>
<span id="cb29-12"><a href="#cb29-12"></a>{</span>
<span id="cb29-13"><a href="#cb29-13"></a>  g&lt;-{(u<span class="op">*</span>x[i]<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(sigma<span class="op">^</span><span class="dv">2</span>)}<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(u<span class="op">*</span>x[i])<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb29-14"><a href="#cb29-14"></a>  cdf[i]&lt;-<span class="kw">mean</span>(g)</span>
<span id="cb29-15"><a href="#cb29-15"></a>  }</span>
<span id="cb29-16"><a href="#cb29-16"></a>  cdf</span>
<span id="cb29-17"><a href="#cb29-17"></a>}</span>
<span id="cb29-18"><a href="#cb29-18"></a>x&lt;-<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="dv">3</span>,<span class="dt">length=</span><span class="dv">10</span>)</span>
<span id="cb29-19"><a href="#cb29-19"></a>Phi&lt;-<span class="kw">pnorm</span>(x)</span>
<span id="cb29-20"><a href="#cb29-20"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb29-21"><a href="#cb29-21"></a>MC1&lt;-<span class="kw">MC.Phi</span>(x,<span class="dt">antithetic=</span><span class="ot">FALSE</span>)</span>
<span id="cb29-22"><a href="#cb29-22"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb29-23"><a href="#cb29-23"></a>MC2&lt;-<span class="kw">MC.Phi</span>(x,<span class="dt">antithetic=</span><span class="ot">TRUE</span>)</span>
<span id="cb29-24"><a href="#cb29-24"></a><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">rbind</span>(x,MC1,MC2,Phi),<span class="dv">5</span>))</span></code></pre></div>
<pre><code>##        [,1]    [,2]    [,3]    [,4]    [,5]    [,6]    [,7]    [,8]    [,9]
## x   0.10000 0.42222 0.74444 1.06667 1.38889 1.71111 2.03333 2.35556 2.67778
## MC1 0.00498 0.08520 0.24180 0.43348 0.61834 0.76816 0.87299 0.93727 0.97212
## MC2 0.00499 0.08528 0.24201 0.43379 0.61871 0.76848 0.87318 0.93725 0.97186
## Phi 0.53983 0.66357 0.77170 0.85694 0.91757 0.95647 0.97899 0.99075 0.99629
##       [,10]
## x   3.00000
## MC1 0.98897
## MC2 0.98844
## Phi 0.99865</code></pre>
<p>The approximate reduction in variance can be estimated for given x by a simulation under antithetic variable method and the simple Monte Carlo integration method.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">set.seed</span>(<span class="dv">1014</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>MC1&lt;-MC2&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb31-4"><a href="#cb31-4"></a>x&lt;-<span class="fl">4.5</span></span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)</span>
<span id="cb31-6"><a href="#cb31-6"></a>{</span>
<span id="cb31-7"><a href="#cb31-7"></a>  MC1[i]&lt;-<span class="kw">MC.Phi</span>(x,<span class="dt">R=</span><span class="dv">1000</span>,<span class="dt">antithetic=</span><span class="ot">FALSE</span>)</span>
<span id="cb31-8"><a href="#cb31-8"></a>  MC2[i]&lt;-<span class="kw">MC.Phi</span>(x,<span class="dt">R=</span><span class="dv">1000</span>,<span class="dt">antithetic=</span><span class="ot">TRUE</span>)</span>
<span id="cb31-9"><a href="#cb31-9"></a>}</span>
<span id="cb31-10"><a href="#cb31-10"></a></span>
<span id="cb31-11"><a href="#cb31-11"></a><span class="kw">print</span>(<span class="kw">sd</span>(MC1));<span class="kw">print</span>(<span class="kw">sd</span>(MC2));<span class="kw">print</span>((<span class="kw">var</span>(MC1)<span class="op">-</span><span class="kw">var</span>(MC2))<span class="op">/</span><span class="kw">var</span>(MC1))<span class="op">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 0.03170338</code></pre>
<pre><code>## [1] 0.01489462</code></pre>
<pre><code>## [1] 0.7792768</code></pre>
<pre><code>## [1] 77.92768</code></pre>
<p>the percent reduction in variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1,X_2\)</span> achieved approximately 77.9% reduction in variance at x=4.5</p>
</div>
<div id="question-5.13" class="section level2">
<h2>Question 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on (1,∞) and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},x&gt;1
\]</span> Which of your importance functions should produce the smaller varience in estimating <span class="math display">\[
\int_{1}^{∞}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx
\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-5.13" class="section level2">
<h2>Answer 5.13</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>g&lt;-<span class="cf">function</span>(x)</span>
<span id="cb36-2"><a href="#cb36-2"></a>{</span>
<span id="cb36-3"><a href="#cb36-3"></a>  (x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)</span>
<span id="cb36-4"><a href="#cb36-4"></a>}</span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="kw">integrate</span>(g,<span class="dv">1</span>,<span class="ot">Inf</span>)</span></code></pre></div>
<pre><code>## 0.400626 with absolute error &lt; 5.7e-07</code></pre>
<p>Find two importance functions <span class="math inline">\(f_1=e^{-(x-1)}I(x&gt;1)\)</span> and <span class="math inline">\(f_2=\frac{4}{\pi(1+x^2)}I(x&gt;1)\)</span> that are supported on (1,∞) and are ‘close’ to g(x)</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">set.seed</span>(<span class="dv">1014</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a>f1&lt;-<span class="cf">function</span>(x)</span>
<span id="cb38-3"><a href="#cb38-3"></a>{</span>
<span id="cb38-4"><a href="#cb38-4"></a>  <span class="kw">exp</span>(<span class="op">-</span>(x<span class="dv">-1</span>))<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)</span>
<span id="cb38-5"><a href="#cb38-5"></a>}</span>
<span id="cb38-6"><a href="#cb38-6"></a>f2&lt;-<span class="cf">function</span>(x)</span>
<span id="cb38-7"><a href="#cb38-7"></a>{</span>
<span id="cb38-8"><a href="#cb38-8"></a>  ((<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">4</span><span class="op">/</span>pi)</span>
<span id="cb38-9"><a href="#cb38-9"></a>}</span>
<span id="cb38-10"><a href="#cb38-10"></a>m&lt;-<span class="fl">1e7</span></span>
<span id="cb38-11"><a href="#cb38-11"></a>u&lt;-<span class="kw">runif</span>(m)</span>
<span id="cb38-12"><a href="#cb38-12"></a>x1&lt;-<span class="dv">1</span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u)</span>
<span id="cb38-13"><a href="#cb38-13"></a>x2&lt;-<span class="kw">tan</span>(pi<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>u)<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb38-14"><a href="#cb38-14"></a>fg&lt;-<span class="kw">cbind</span>(<span class="kw">g</span>(x1)<span class="op">/</span><span class="kw">f1</span>(x1),<span class="kw">g</span>(x2)<span class="op">/</span><span class="kw">f2</span>(x2))</span>
<span id="cb38-15"><a href="#cb38-15"></a>theta.hat&lt;-se&lt;-<span class="kw">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb38-16"><a href="#cb38-16"></a>theta.hat&lt;-<span class="kw">c</span>(<span class="kw">mean</span>(fg[,<span class="dv">1</span>]),<span class="kw">mean</span>(fg[,<span class="dv">2</span>]))</span>
<span id="cb38-17"><a href="#cb38-17"></a>se&lt;-<span class="kw">c</span>(<span class="kw">sd</span>(fg[,<span class="dv">1</span>]),<span class="kw">sd</span>(fg[,<span class="dv">2</span>]))</span>
<span id="cb38-18"><a href="#cb38-18"></a><span class="kw">rbind</span>(theta.hat,se)</span></code></pre></div>
<pre><code>##                [,1]      [,2]
## theta.hat 0.4006216 0.4006878
## se        0.1575414 0.3308799</code></pre>
<p><span class="math inline">\(0.1575414=se(\hat\theta_1) &lt; se(\hat\theta_2)=0.3308799\)</span> <span class="math inline">\(f_1=e^{-(x-1)}I(x&gt;1)\)</span>produce the smaller varience in estimating <span class="math inline">\(\int_{1}^{∞}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\)</span></p>
</div>
<div id="question-5.14" class="section level2">
<h2>Question 5.14</h2>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[
\int_{1}^{∞}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx
\]</span> by importance sampling.</p>
</div>
<div id="answer-5.14" class="section level2">
<h2>Answer 5.14</h2>
<p>consider a importance function: <span class="math display">\[
f(x)=e^{-x}I(x&gt;0)\\
\]</span></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">set.seed</span>(<span class="dv">1014</span>)</span>
<span id="cb40-2"><a href="#cb40-2"></a>m&lt;-<span class="fl">1e6</span></span>
<span id="cb40-3"><a href="#cb40-3"></a>theta.hat&lt;-se&lt;-<span class="kw">numeric</span>(<span class="dv">1</span>)</span>
<span id="cb40-4"><a href="#cb40-4"></a>g&lt;-<span class="cf">function</span>(x)</span>
<span id="cb40-5"><a href="#cb40-5"></a>{</span>
<span id="cb40-6"><a href="#cb40-6"></a>  (x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)</span>
<span id="cb40-7"><a href="#cb40-7"></a>}</span>
<span id="cb40-8"><a href="#cb40-8"></a><span class="kw">integrate</span>(g,<span class="dv">1</span>,<span class="ot">Inf</span>)</span></code></pre></div>
<pre><code>## 0.400626 with absolute error &lt; 5.7e-07</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>x&lt;-<span class="kw">rexp</span>(m,<span class="dv">1</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a>fg&lt;-<span class="kw">g</span>(x)<span class="op">/</span><span class="kw">exp</span>(<span class="op">-</span>x)</span>
<span id="cb42-3"><a href="#cb42-3"></a>theta.hat&lt;-<span class="kw">mean</span>(fg)</span>
<span id="cb42-4"><a href="#cb42-4"></a>se&lt;-<span class="kw">sd</span>(fg)</span>
<span id="cb42-5"><a href="#cb42-5"></a><span class="kw">rbind</span>(theta.hat,se)</span></code></pre></div>
<pre><code>##                [,1]
## theta.hat 0.4007930
## se        0.5858188</code></pre>
<p>So we get a Monte Carlo estimate of <span class="math inline">\(\int_{1}^{∞}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\)</span> is <span class="math display">\[
\hat\theta=\frac{1}{m}\sum_{i=1}^{m}\frac{g(X_i)}{f(X_i)}=\frac{1}{m}\sum_{i=1}^{m}\frac{X_i^2}{\sqrt{2\pi}}e^{X_i-X_i^2/2}
\]</span> ## title: “A-21010-2021-10-14”</p>
</div>
<div id="exercises-6.5-and-6.apage-180-181statistical-computating-with-r." class="section level2">
<h2>Exercises 6.5 and 6.A(page 180-181,Statistical Computating with R).</h2>
</div>
<div id="if-we-obtain-the-powers-for-two-methods-under-a-particular-simulation-setting-with-10000-experiments-say0.651-for-one-method-and-0.676-for-another-method.-we-want-to-know-if-the-powers-are-different-at-0.05-level." class="section level2">
<h2>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say,0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</h2>
</div>
<div id="what-is-the-corresponding-hypothesis-test-problem" class="section level2">
<h2>(1)What is the corresponding hypothesis test problem?</h2>
</div>
<div id="what-test-should-we-use-z-test-two-sample-t-test-paired-t-test-or-mcnemar-test-why" class="section level2">
<h2>(2)what test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</h2>
</div>
<div id="please-provide-the-least-necessary-information-for-hypothesis-testing." class="section level2">
<h2>(3)Please provide the least necessary information for hypothesis testing.</h2>
</div>
<div id="question-6.5" class="section level2">
<h2>Question 6.5</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample date are non-normal.Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95.Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span>data with sample size n=20.Compare your t-interval results with the simulation results in Example 6.4 (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-6.5" class="section level2">
<h2>Answer 6.5</h2>
<p>:<br />
Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span>data with sample size n=20.<br />
</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb44-2"><a href="#cb44-2"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb44-3"><a href="#cb44-3"></a>n&lt;-<span class="dv">20</span></span>
<span id="cb44-4"><a href="#cb44-4"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb44-5"><a href="#cb44-5"></a>UCL&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb44-6"><a href="#cb44-6"></a>LCL&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) </span>
<span id="cb44-8"><a href="#cb44-8"></a>{</span>
<span id="cb44-9"><a href="#cb44-9"></a>  x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb44-10"><a href="#cb44-10"></a>  LCL[i]&lt;-<span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span>(<span class="kw">sqrt</span>(n))</span>
<span id="cb44-11"><a href="#cb44-11"></a>  UCL[i]&lt;-<span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span>(<span class="kw">sqrt</span>(n))</span>
<span id="cb44-12"><a href="#cb44-12"></a>}</span>
<span id="cb44-13"><a href="#cb44-13"></a><span class="kw">mean</span>(LCL<span class="op">&lt;</span><span class="dv">2</span><span class="op">&amp;</span>UCL<span class="op">&gt;</span><span class="dv">2</span>) <span class="co">## coverage probability of the t-interval</span></span></code></pre></div>
<pre><code>## [1] 0.9175</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>UCL1&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb46-2"><a href="#cb46-2"></a>LCL1&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) </span>
<span id="cb46-4"><a href="#cb46-4"></a>{</span>
<span id="cb46-5"><a href="#cb46-5"></a>  x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb46-6"><a href="#cb46-6"></a>  LCL1[i]&lt;-<span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">qnorm</span>(alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span>(<span class="kw">sqrt</span>(n))</span>
<span id="cb46-7"><a href="#cb46-7"></a>  UCL1[i]&lt;-<span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">qnorm</span>(alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span>(<span class="kw">sqrt</span>(n))</span>
<span id="cb46-8"><a href="#cb46-8"></a>}</span>
<span id="cb46-9"><a href="#cb46-9"></a><span class="kw">mean</span>(LCL1<span class="op">&lt;</span><span class="dv">2</span><span class="op">&amp;</span>UCL1<span class="op">&gt;</span><span class="dv">2</span>) <span class="co">## coverage probability of the normality interval</span></span></code></pre></div>
<pre><code>## [1] 0.8974</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb48-3"><a href="#cb48-3"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="kw">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb48-5"><a href="#cb48-5"></a>xbar &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb48-6"><a href="#cb48-6"></a>es &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb48-7"><a href="#cb48-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb48-8"><a href="#cb48-8"></a>   xbar[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>))</span>
<span id="cb48-9"><a href="#cb48-9"></a>   es[i] &lt;-<span class="st"> </span><span class="kw">qt</span>((<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>),n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(<span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb48-10"><a href="#cb48-10"></a>}</span>
<span id="cb48-11"><a href="#cb48-11"></a><span class="co"># The symmetric t-interval to estimate a mean is xbar +(-) t(1-α/2)(n-1)s/sqrt(n)</span></span>
<span id="cb48-12"><a href="#cb48-12"></a>p &lt;-<span class="st"> </span><span class="kw">mean</span>((xbar<span class="op">-</span>es)<span class="op">&lt;</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span><span class="dv">2</span><span class="op">&lt;</span>(xbar<span class="op">+</span>es))</span>
<span id="cb48-13"><a href="#cb48-13"></a><span class="co">#Judging  whether the mean of the populations falling within the confidence interval generated by the samples subject to the chi-square distribution, thus obtaining the probability that the confidence interval covers the mean</span></span>
<span id="cb48-14"><a href="#cb48-14"></a>p</span></code></pre></div>
<pre><code>## [1] 0.9226</code></pre>
<p>Conclusion:The t-interval should be more robust.</p>
</div>
<div id="question-6.a" class="section level2">
<h2>Question 6.A</h2>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>,when the sampled population is non-normal.The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i)<span class="math inline">\(\chi^2(1)\)</span>,(ii)Uniform(0,2),and (iii)Exponential(rate=1).In each case,test <span class="math inline">\(H_0:\mu=\mu_0\)</span>vs<span class="math inline">\(H_a:\mu\neq\mu_0\)</span>,where <span class="math inline">\(\mu_0\)</span>is the mean of <span class="math inline">\(\chi^2(1)\)</span>,Uniform(0,2),and Exponential(1),respectively.</p>
</div>
<div id="answer-6.a" class="section level2">
<h2>Answer 6.A</h2>
<p>: (1) for chisquare distribution with 1 degrees of freedom.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb50-2"><a href="#cb50-2"></a>n&lt;-<span class="dv">1000</span></span>
<span id="cb50-3"><a href="#cb50-3"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb50-4"><a href="#cb50-4"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb50-5"><a href="#cb50-5"></a>p&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb50-6"><a href="#cb50-6"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb50-7"><a href="#cb50-7"></a>u1=<span class="kw">runif</span>(n)</span>
<span id="cb50-8"><a href="#cb50-8"></a>u2=<span class="kw">runif</span>(n)</span>
<span id="cb50-9"><a href="#cb50-9"></a>z=<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(u1))<span class="op">*</span><span class="kw">cos</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>u2)</span>
<span id="cb50-10"><a href="#cb50-10"></a>x=z<span class="op">^</span><span class="dv">2</span></span>
<span id="cb50-11"><a href="#cb50-11"></a>ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu =</span> <span class="dv">1</span>)</span>
<span id="cb50-12"><a href="#cb50-12"></a>p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</span>
<span id="cb50-13"><a href="#cb50-13"></a>}</span>
<span id="cb50-14"><a href="#cb50-14"></a>p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</span>
<span id="cb50-15"><a href="#cb50-15"></a><span class="kw">print</span>(<span class="kw">c</span>(p.hat,alpha))</span></code></pre></div>
<pre><code>## [1] 0.0535 0.0500</code></pre>
<p>Conculsion:<br />
(i)the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>.<br />
(ii)p-value&gt;alpha,accept <span class="math inline">\(H_0:\mu=1\)</span>.<br />
(2)For uniform distribution with parameter a=0 and b=2.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="kw">set.seed</span>(<span class="dv">23569</span>)</span>
<span id="cb52-2"><a href="#cb52-2"></a>n&lt;-<span class="dv">1000</span></span>
<span id="cb52-3"><a href="#cb52-3"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb52-4"><a href="#cb52-4"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb52-5"><a href="#cb52-5"></a>p&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb52-6"><a href="#cb52-6"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb52-7"><a href="#cb52-7"></a>u=<span class="kw">runif</span>(n)</span>
<span id="cb52-8"><a href="#cb52-8"></a>x=<span class="dv">2</span><span class="op">*</span>u</span>
<span id="cb52-9"><a href="#cb52-9"></a>ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu =</span> <span class="dv">1</span>)</span>
<span id="cb52-10"><a href="#cb52-10"></a>p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</span>
<span id="cb52-11"><a href="#cb52-11"></a>}</span>
<span id="cb52-12"><a href="#cb52-12"></a>p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</span>
<span id="cb52-13"><a href="#cb52-13"></a><span class="kw">print</span>(<span class="kw">c</span>(p.hat,alpha))</span></code></pre></div>
<pre><code>## [1] 0.0506 0.0500</code></pre>
<p>Conculsion:<br />
(i)the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>.<br />
(ii)p-value&gt;alpha,accept <span class="math inline">\(H_0:\mu=1\)</span>.<br />
(3)for exponential distribution with mean 1.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw">set.seed</span>(<span class="dv">17852</span>)</span>
<span id="cb54-2"><a href="#cb54-2"></a>n&lt;-<span class="dv">1000</span></span>
<span id="cb54-3"><a href="#cb54-3"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb54-4"><a href="#cb54-4"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb54-5"><a href="#cb54-5"></a>p&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb54-6"><a href="#cb54-6"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb54-7"><a href="#cb54-7"></a>u=<span class="kw">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb54-8"><a href="#cb54-8"></a>x=<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u)</span>
<span id="cb54-9"><a href="#cb54-9"></a>ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu =</span> <span class="dv">1</span>)</span>
<span id="cb54-10"><a href="#cb54-10"></a>p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</span>
<span id="cb54-11"><a href="#cb54-11"></a>}</span>
<span id="cb54-12"><a href="#cb54-12"></a>p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</span>
<span id="cb54-13"><a href="#cb54-13"></a><span class="kw">print</span>(<span class="kw">c</span>(p.hat,alpha))</span></code></pre></div>
<pre><code>## [1] 0.0502 0.0500</code></pre>
<p>Conculsion:<br />
(i)the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>.<br />
(ii)p-value&gt;alpha,accept <span class="math inline">\(H_0:\mu=1\)</span>.、 As can be seen from the table, we can find the empirical Type I error rate of the t-test is approximately equal to the nominal significance level α, when the sampled population is non-normal(such as <span class="math inline">\(\chi^{2}(1)\)</span>, Uniform(0,2) and Exponential(rate=1). The t-test is robust to mild departures from normality and all accept <span class="math inline">\(H_0:\mu=1\)</span>.</p>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say,0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level. (1)What is the corresponding hypothesis test problem? (2)what test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why? (3)Please provide the least necessary information for hypothesis testing.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>:<br />
We may can’t say the powers are different at 0.05 level.<br />
</p>
<p>(1)The corresponding hypothesis test problem is whether the powers are different, that is “<span class="math inline">\(H_{0}: power_{1}=power_{2}\)</span> vs <span class="math inline">\(H_{1}: power_{1} \neq power_{2}\)</span>”.<br />
(2)We should use paired-t test.<br />
(3)There is only one sample for each of <span class="math inline">\(power_{1}\)</span> and <span class="math inline">\(power_{2}\)</span> in the title, so multiple experiments should be performed to generate a plurality of <span class="math inline">\(power_{1}\)</span> and <span class="math inline">\(power_{2}\)</span>, thereby obtaining a plurality of differences of <span class="math inline">\(power_{1}\)</span> and <span class="math inline">\(power_{2}\)</span>. It is noted that the difference between <span class="math inline">\(power_{1}\)</span> and <span class="math inline">\(ppwer_{2}\)</span> is d, a plurality of d approximately obey the t distribution. The null hypothesis can be tested by applying paired-t test.</p>
</div>
<div id="title-a-21010-2021-10-21" class="section level2">
<h2>title: “A-21010-2021-10-21”</h2>
</div>
<div id="exercise-6.c-pages-182statistical-computing-with-r." class="section level2">
<h2>Exercise 6.C (pages 182,Statistical Computing with R).</h2>
</div>
<div id="question-6.c" class="section level2">
<h2>Question 6.C</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test.Mardia[187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis.If X and Y are iid,the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as<br />
<span class="math display">\[
\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3.
\]</span><br />
under normality,<span class="math inline">\(\beta_{1,d}=0\)</span>.The multivariate skewness statistic is<br />
<span class="math display">\[
b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^{n}((X_i-\bar{X})^T{\hat{\Sigma}}^{-1}(X_j-\bar{X}))^3,
\]</span><br />
where <span class="math inline">\(\hat\Sigma\)</span> is the maximum likelihood estimator of covariance.Large values of <span class="math inline">\(b_{1,d}\)</span> are significant.The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d+1)(d+2)/6\)</span> degrees of freedom.<br />
</p>
<p><strong>Solution:</strong> The test problem:<br />
<span class="math inline">\(H_0:\beta_{1,d}=0\)</span> vs <span class="math inline">\(H_a:\beta_{1,d}\neq0\)</span>.<br />
The test statistic:<br />
<span class="math display">\[
\chi^2=nb_{1,d}/6=\frac{1}{6n}\sum_{i,j=1}^{n}((X_i-\bar{X})^T{\hat{\Sigma}}^{-1}(X_j-\bar{X}))^3
\]</span><br />
<span class="math inline">\(\chi^2=nb_{1,d}/6\sim\chi^2(\frac{d(d+1)(d+2)}{6})\)</span>where d is dimension of <span class="math inline">\(X\)</span> when <span class="math inline">\(H_0:\beta_{1,d}=0\)</span> is right.<br />
critical.value:<br />
so <span class="math inline">\(H_0:\beta_{1,d}=0\)</span> is rejected if <span class="math inline">\(\chi^2&gt;\chi^2_{\alpha}(\frac{d(d+1)(d+2)}{6})\)</span>.<br />
</p>
<p><strong>Repeat Examples 6.8:</strong> Assess the Type I error rate for a skewness test of normality at <span class="math inline">\(\alpha=0.05\)</span> based on the asymptotic distribution of <span class="math inline">\(b_{1,d}\)</span> for sample sizes n=10,20,30,50,100,500 and 1000.<br />
Let d=1,2,3 to repeat this experiment m=10000 times, respectively.<br />
</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb56-2"><a href="#cb56-2"></a>c.v=<span class="cf">function</span>(d){</span>
<span id="cb56-3"><a href="#cb56-3"></a>  <span class="kw">return</span>(<span class="kw">qchisq</span>(<span class="fl">0.95</span>,<span class="dt">df=</span>d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>))</span>
<span id="cb56-4"><a href="#cb56-4"></a>}</span>
<span id="cb56-5"><a href="#cb56-5"></a>critical.value=<span class="kw">c</span>(<span class="kw">c.v</span>(<span class="dv">1</span>),<span class="kw">c.v</span>(<span class="dv">2</span>),<span class="kw">c.v</span>(<span class="dv">3</span>)) <span class="co">## compute the critiacal values for each d</span></span>
<span id="cb56-6"><a href="#cb56-6"></a>s&lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb56-7"><a href="#cb56-7"></a>  statistic=<span class="dv">0</span></span>
<span id="cb56-8"><a href="#cb56-8"></a>  sigma=<span class="kw">cov</span>(x,x)</span>
<span id="cb56-9"><a href="#cb56-9"></a>  n=<span class="kw">dim</span>(x)[<span class="dv">1</span>]</span>
<span id="cb56-10"><a href="#cb56-10"></a>  d=<span class="kw">dim</span>(x)[<span class="dv">2</span>]</span>
<span id="cb56-11"><a href="#cb56-11"></a>  matrix=(<span class="kw">scale</span>(x))<span class="op">%*%</span><span class="kw">t</span>(<span class="kw">scale</span>(x))</span>
<span id="cb56-12"><a href="#cb56-12"></a>  statistic=<span class="kw">sum</span>(matrix<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb56-13"><a href="#cb56-13"></a>  <span class="kw">return</span>( statistic<span class="op">/</span>n<span class="op">/</span><span class="dv">6</span> )</span>
<span id="cb56-14"><a href="#cb56-14"></a>} <span class="co">## computes the sample skewness</span></span>
<span id="cb56-15"><a href="#cb56-15"></a>n&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>) <span class="co">## sample sizes</span></span>
<span id="cb56-16"><a href="#cb56-16"></a>m&lt;-<span class="fl">1e4</span> <span class="co">## repeat experiment times</span></span>
<span id="cb56-17"><a href="#cb56-17"></a>Type.I.error=<span class="kw">matrix</span>(<span class="dt">nrow=</span><span class="kw">length</span>(n),<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb56-18"><a href="#cb56-18"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb56-19"><a href="#cb56-19"></a>  <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</span>
<span id="cb56-20"><a href="#cb56-20"></a>    result=<span class="kw">numeric</span>(m)</span>
<span id="cb56-21"><a href="#cb56-21"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb56-22"><a href="#cb56-22"></a>      x=<span class="kw">array</span>(<span class="kw">rnorm</span>(n[i]<span class="op">*</span>d),<span class="dt">dim=</span><span class="kw">c</span>(n[i],d))</span>
<span id="cb56-23"><a href="#cb56-23"></a>      result[j]=<span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">s</span>(x)) <span class="op">&gt;=</span>critical.value[d] )</span>
<span id="cb56-24"><a href="#cb56-24"></a>    }</span>
<span id="cb56-25"><a href="#cb56-25"></a>    Type.I.error[i,d]=<span class="kw">mean</span>(result)</span>
<span id="cb56-26"><a href="#cb56-26"></a>  }</span>
<span id="cb56-27"><a href="#cb56-27"></a>}</span>
<span id="cb56-28"><a href="#cb56-28"></a><span class="kw">dimnames</span>(Type.I.error)[[<span class="dv">1</span>]]=<span class="kw">c</span>(<span class="st">&quot;size=10&quot;</span>,<span class="st">&quot;size=20&quot;</span>,<span class="st">&quot;size=30&quot;</span>,<span class="st">&quot;size=50&quot;</span>,<span class="st">&quot;size=100&quot;</span>,<span class="st">&quot;size=500&quot;</span>)</span>
<span id="cb56-29"><a href="#cb56-29"></a><span class="kw">dimnames</span>(Type.I.error)[[<span class="dv">2</span>]]=<span class="kw">c</span>(<span class="st">&quot;d=1&quot;</span>,<span class="st">&quot;d=2&quot;</span>,<span class="st">&quot;d=3&quot;</span>)</span>
<span id="cb56-30"><a href="#cb56-30"></a><span class="kw">print</span>(Type.I.error)</span></code></pre></div>
<pre><code>##             d=1    d=2    d=3
## size=10  0.0039 0.0084 0.0102
## size=20  0.0205 0.0231 0.0261
## size=30  0.0309 0.0301 0.0354
## size=50  0.0359 0.0453 0.0415
## size=100 0.0405 0.0413 0.0528
## size=500 0.0512 0.0498 0.0511</code></pre>
<p><br />
So when the size of sample is large, the Type I error rate gets close to nominal level <span class="math inline">\(\alpha=0.05\)</span>.<br />
<strong>Repeat Examples 6.10:</strong> The skewness test of normality was desribed in Repeat Example 6.8.In this example,we estimate by simulation the power of the skewness test of normality against a contaminated normal (normal scale mixture) alternative described in Example 6.3.he contaminated normal distribution is denoted by<br />
<span class="math display">\[
(1-\epsilon)N(\mu=0,\sigma^2=1)+\epsilon N(\mu=0,\sigma^2=100),0\leq \epsilon \leq1
\]</span><br />
When <span class="math inline">\(\epsilon=0\)</span> or <span class="math inline">\(\epsilon=1\)</span>the distribution is normal, but the mixture is nonnormal for <span class="math inline">\(0\leq \epsilon \leq1\)</span>. We can estimate the power of the skewness test for a sequence of alternatives indexed by ε and plot a power curve for the power of the skewness test against this type of alternative. For this experiment, the significance level is <span class="math inline">\(\alpha=0.05\)</span> and the sample size is n=100, the dimension d=1，2，3.<br />
</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb58-2"><a href="#cb58-2"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb58-3"><a href="#cb58-3"></a>n&lt;-<span class="dv">100</span></span>
<span id="cb58-4"><a href="#cb58-4"></a>m&lt;-<span class="dv">5000</span></span>
<span id="cb58-5"><a href="#cb58-5"></a>eps&lt;-<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.2</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb58-6"><a href="#cb58-6"></a>N&lt;-<span class="kw">length</span>(eps)</span>
<span id="cb58-7"><a href="#cb58-7"></a>power1&lt;-<span class="kw">numeric</span>(N)</span>
<span id="cb58-8"><a href="#cb58-8"></a>c.v=<span class="cf">function</span>(d){</span>
<span id="cb58-9"><a href="#cb58-9"></a>  <span class="kw">return</span>(<span class="kw">qchisq</span>(<span class="fl">0.95</span>,<span class="dt">df=</span>d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>))</span>
<span id="cb58-10"><a href="#cb58-10"></a>}</span>
<span id="cb58-11"><a href="#cb58-11"></a>critical.value=<span class="kw">c</span>(<span class="kw">c.v</span>(<span class="dv">1</span>),<span class="kw">c.v</span>(<span class="dv">2</span>),<span class="kw">c.v</span>(<span class="dv">3</span>)) <span class="co">## compute the critiacal values for each d</span></span>
<span id="cb58-12"><a href="#cb58-12"></a>s&lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb58-13"><a href="#cb58-13"></a>  statistic=<span class="dv">0</span></span>
<span id="cb58-14"><a href="#cb58-14"></a>  sigma=<span class="kw">cov</span>(x,x)</span>
<span id="cb58-15"><a href="#cb58-15"></a>  n=<span class="kw">dim</span>(x)[<span class="dv">1</span>]</span>
<span id="cb58-16"><a href="#cb58-16"></a>  matrix=(<span class="kw">scale</span>(x))<span class="op">%*%</span><span class="kw">t</span>(<span class="kw">scale</span>(x))</span>
<span id="cb58-17"><a href="#cb58-17"></a>  statistic=<span class="kw">sum</span>(matrix<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb58-18"><a href="#cb58-18"></a>  <span class="kw">return</span>( statistic<span class="op">/</span>n<span class="op">/</span><span class="dv">6</span> ) </span>
<span id="cb58-19"><a href="#cb58-19"></a>} <span class="co">## computes the sample skewness</span></span>
<span id="cb58-20"><a href="#cb58-20"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </span>
<span id="cb58-21"><a href="#cb58-21"></a> e&lt;-eps[j]</span>
<span id="cb58-22"><a href="#cb58-22"></a> sktests1&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb58-23"><a href="#cb58-23"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </span>
<span id="cb58-24"><a href="#cb58-24"></a> sig1&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,<span class="dt">size =</span> n<span class="op">*</span><span class="dv">1</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb58-25"><a href="#cb58-25"></a> x=<span class="kw">array</span>(<span class="kw">rnorm</span>(<span class="dv">30</span><span class="op">*</span><span class="dv">1</span>,<span class="dv">0</span>,sig1),<span class="dt">dim=</span><span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">1</span>))</span>
<span id="cb58-26"><a href="#cb58-26"></a> sktests1[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">s</span>(x) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">c.v</span>(<span class="dv">1</span>))</span>
<span id="cb58-27"><a href="#cb58-27"></a>}</span>
<span id="cb58-28"><a href="#cb58-28"></a>power1[j]&lt;-<span class="kw">mean</span>(sktests1)</span>
<span id="cb58-29"><a href="#cb58-29"></a>}</span>
<span id="cb58-30"><a href="#cb58-30"></a><span class="kw">plot</span>(eps, power1, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb58-31"><a href="#cb58-31"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(eps,<span class="dt">splice =</span> <span class="ot">FALSE</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main=</span><span class="st">&quot;Power of demension one&quot;</span>)</span>
<span id="cb58-32"><a href="#cb58-32"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="ot">NULL</span>,<span class="dt">b=</span><span class="ot">NULL</span>,<span class="dt">h =</span> <span class="fl">0.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="kw">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb59-2"><a href="#cb59-2"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb59-3"><a href="#cb59-3"></a>n&lt;-<span class="dv">100</span></span>
<span id="cb59-4"><a href="#cb59-4"></a>m&lt;-<span class="dv">5000</span></span>
<span id="cb59-5"><a href="#cb59-5"></a>eps&lt;-<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.2</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb59-6"><a href="#cb59-6"></a>N&lt;-<span class="kw">length</span>(eps)</span>
<span id="cb59-7"><a href="#cb59-7"></a>power2&lt;-<span class="kw">numeric</span>(N)</span>
<span id="cb59-8"><a href="#cb59-8"></a>c.v=<span class="cf">function</span>(d){</span>
<span id="cb59-9"><a href="#cb59-9"></a>  <span class="kw">return</span>(<span class="kw">qchisq</span>(<span class="fl">0.95</span>,<span class="dt">df=</span>d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>))</span>
<span id="cb59-10"><a href="#cb59-10"></a>}</span>
<span id="cb59-11"><a href="#cb59-11"></a>critical.value=<span class="kw">c</span>(<span class="kw">c.v</span>(<span class="dv">1</span>),<span class="kw">c.v</span>(<span class="dv">2</span>),<span class="kw">c.v</span>(<span class="dv">3</span>)) <span class="co">## compute the critiacal values for each d</span></span>
<span id="cb59-12"><a href="#cb59-12"></a>s&lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb59-13"><a href="#cb59-13"></a>  statistic=<span class="dv">0</span></span>
<span id="cb59-14"><a href="#cb59-14"></a>  sigma=<span class="kw">cov</span>(x,x)</span>
<span id="cb59-15"><a href="#cb59-15"></a>  n=<span class="kw">dim</span>(x)[<span class="dv">1</span>]</span>
<span id="cb59-16"><a href="#cb59-16"></a>  matrix=(<span class="kw">scale</span>(x))<span class="op">%*%</span><span class="kw">t</span>(<span class="kw">scale</span>(x))</span>
<span id="cb59-17"><a href="#cb59-17"></a>  statistic=<span class="kw">sum</span>(matrix<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb59-18"><a href="#cb59-18"></a>  <span class="kw">return</span>( statistic<span class="op">/</span>n<span class="op">/</span><span class="dv">6</span> ) </span>
<span id="cb59-19"><a href="#cb59-19"></a>} <span class="co">## computes the sample skewness</span></span>
<span id="cb59-20"><a href="#cb59-20"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </span>
<span id="cb59-21"><a href="#cb59-21"></a> e&lt;-eps[j]</span>
<span id="cb59-22"><a href="#cb59-22"></a> sktests2&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb59-23"><a href="#cb59-23"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </span>
<span id="cb59-24"><a href="#cb59-24"></a>  sig2&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,<span class="dt">size =</span> n<span class="op">*</span><span class="dv">2</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb59-25"><a href="#cb59-25"></a> x=<span class="kw">array</span>(<span class="kw">rnorm</span>(<span class="dv">30</span><span class="op">*</span><span class="dv">2</span>,<span class="dv">0</span>,sig2),<span class="dt">dim=</span><span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">2</span>))</span>
<span id="cb59-26"><a href="#cb59-26"></a> sktests2[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">s</span>(x) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">c.v</span>(<span class="dv">2</span>))</span>
<span id="cb59-27"><a href="#cb59-27"></a>}</span>
<span id="cb59-28"><a href="#cb59-28"></a>power2[j]&lt;-<span class="kw">mean</span>(sktests2)</span>
<span id="cb59-29"><a href="#cb59-29"></a>}</span>
<span id="cb59-30"><a href="#cb59-30"></a><span class="kw">plot</span>(eps, power2, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb59-31"><a href="#cb59-31"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(eps,<span class="dt">splice =</span> <span class="ot">FALSE</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main=</span><span class="st">&quot;Power of demension two&quot;</span>)</span>
<span id="cb59-32"><a href="#cb59-32"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="ot">NULL</span>,<span class="dt">b=</span><span class="ot">NULL</span>,<span class="dt">h =</span> <span class="fl">0.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="kw">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb60-2"><a href="#cb60-2"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb60-3"><a href="#cb60-3"></a>n&lt;-<span class="dv">100</span></span>
<span id="cb60-4"><a href="#cb60-4"></a>m&lt;-<span class="dv">5000</span></span>
<span id="cb60-5"><a href="#cb60-5"></a>eps&lt;-<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.2</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb60-6"><a href="#cb60-6"></a>N&lt;-<span class="kw">length</span>(eps)</span>
<span id="cb60-7"><a href="#cb60-7"></a>power3&lt;-<span class="kw">numeric</span>(N)</span>
<span id="cb60-8"><a href="#cb60-8"></a>c.v=<span class="cf">function</span>(d){</span>
<span id="cb60-9"><a href="#cb60-9"></a>  <span class="kw">return</span>(<span class="kw">qchisq</span>(<span class="fl">0.95</span>,<span class="dt">df=</span>d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>))</span>
<span id="cb60-10"><a href="#cb60-10"></a>}</span>
<span id="cb60-11"><a href="#cb60-11"></a>critical.value=<span class="kw">c</span>(<span class="kw">c.v</span>(<span class="dv">1</span>),<span class="kw">c.v</span>(<span class="dv">2</span>),<span class="kw">c.v</span>(<span class="dv">3</span>)) <span class="co">## compute the critiacal values for each d</span></span>
<span id="cb60-12"><a href="#cb60-12"></a>s&lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb60-13"><a href="#cb60-13"></a>  statistic=<span class="dv">0</span></span>
<span id="cb60-14"><a href="#cb60-14"></a>  sigma=<span class="kw">cov</span>(x,x)</span>
<span id="cb60-15"><a href="#cb60-15"></a>  n=<span class="kw">dim</span>(x)[<span class="dv">1</span>]</span>
<span id="cb60-16"><a href="#cb60-16"></a>  matrix=(<span class="kw">scale</span>(x))<span class="op">%*%</span><span class="kw">t</span>(<span class="kw">scale</span>(x))</span>
<span id="cb60-17"><a href="#cb60-17"></a>  statistic=<span class="kw">sum</span>(matrix<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb60-18"><a href="#cb60-18"></a>  <span class="kw">return</span>( statistic<span class="op">/</span>n<span class="op">/</span><span class="dv">6</span> ) </span>
<span id="cb60-19"><a href="#cb60-19"></a>} <span class="co">## computes the sample skewness</span></span>
<span id="cb60-20"><a href="#cb60-20"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </span>
<span id="cb60-21"><a href="#cb60-21"></a> e&lt;-eps[j]</span>
<span id="cb60-22"><a href="#cb60-22"></a> sktests3&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb60-23"><a href="#cb60-23"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </span>
<span id="cb60-24"><a href="#cb60-24"></a>  sig3&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,<span class="dt">size =</span> n<span class="op">*</span><span class="dv">3</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb60-25"><a href="#cb60-25"></a> x=<span class="kw">array</span>(<span class="kw">rnorm</span>(<span class="dv">30</span><span class="op">*</span><span class="dv">3</span>,<span class="dv">0</span>,sig3),<span class="dt">dim=</span><span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">3</span>))</span>
<span id="cb60-26"><a href="#cb60-26"></a> sktests3[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">s</span>(x) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">c.v</span>(<span class="dv">3</span>))</span>
<span id="cb60-27"><a href="#cb60-27"></a>}</span>
<span id="cb60-28"><a href="#cb60-28"></a>power3[j]&lt;-<span class="kw">mean</span>(sktests3)</span>
<span id="cb60-29"><a href="#cb60-29"></a>}</span>
<span id="cb60-30"><a href="#cb60-30"></a><span class="kw">plot</span>(eps, power3, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb60-31"><a href="#cb60-31"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(eps,<span class="dt">splice =</span> <span class="ot">FALSE</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main=</span><span class="st">&quot;Power of demension 3&quot;</span>)</span>
<span id="cb60-32"><a href="#cb60-32"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="ot">NULL</span>,<span class="dt">b=</span><span class="ot">NULL</span>,<span class="dt">h =</span> <span class="fl">0.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> <strong>conclusion:</strong> When <span class="math inline">\(\epsilon=0\)</span> or <span class="math inline">\(\epsilon=1\)</span>the distribution is normal, but the mixture is nonnormal for <span class="math inline">\(0\leq \epsilon \leq1\)</span> for the significance level is <span class="math inline">\(\alpha=0.05\)</span> and the sample size is n=100, the dimension d=1，2，3.And we find the empirical power of the test is higher than 0.05,when<span class="math inline">\(\epsilon\approx0.1\)</span> the empirical power of the test is highest.</p>
</div>
<div id="title-a-21010-2021-10-28" class="section level2">
<h2>title: “A-21010-2021-10-28”</h2>
</div>
<div id="exercise-7.77.87.9and-7.bpagesstatistical-computing-with-r." class="section level2">
<h2>Exercise 7.7,7.8,7.9,and 7.B(pages,Statistical Computing with R).</h2>
</div>
<div id="question-7.7" class="section level2">
<h2>Question 7.7</h2>
<p>Refer to Exercise 7.6. Efron and Tibshirani discuss the following example [84,Ch. 7]. The five-dimensional scores data have a 5 × 5 covariance matrix <span class="math inline">\(\Sigma\)</span>,with positive eigenvalues <span class="math inline">\(\lambda_1&gt;\cdots&gt;\lambda_5\)</span>. In principal components analysis,<br />
<span class="math display">\[
\theta=\frac{\lambda_1}{\sum_{j=1}^{5}\lambda_j}
\]</span><br />
measures the proportion of variance explained by the first principal component. Let <span class="math inline">\(\hat\lambda_1&gt;\cdots&gt;\hat \lambda_5\)</span> be the eigenvalues of <span class="math inline">\(\hat\Sigma\)</span>, where <span class="math inline">\(\hat\Sigma\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>.Compute the sample estimate<br />
<span class="math display">\[
\hat\theta=\frac{\hat\lambda_1}{\sum_{j=1}^{5}\hat\lambda_j}
\]</span><br />
of <span class="math inline">\(\theta\)</span>.Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat\theta\)</span>.<br />
</p>
<p><strong>Solution:</strong></p>
<p>Refer to Exercise 7.6.Efron and Tibshirani discuss the scor (bootstrap) test score data on 88 students who took examinations in five subjects [84, Table 7.1], [188, Table 1.2.1].The first two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores <span class="math inline">\((x_{i1},\cdots,x_{i5})\)</span> for the <span class="math inline">\(i^{th}\)</span> student.<br />
Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat\theta\)</span>.<br />
</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="kw">data</span>(scor)</span>
<span id="cb61-3"><a href="#cb61-3"></a>X&lt;-scor</span>
<span id="cb61-4"><a href="#cb61-4"></a>n&lt;-<span class="kw">nrow</span>(X)</span>
<span id="cb61-5"><a href="#cb61-5"></a>p&lt;-<span class="kw">ncol</span>(X)</span>
<span id="cb61-6"><a href="#cb61-6"></a><span class="kw">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb61-7"><a href="#cb61-7"></a>B&lt;-<span class="fl">1e4</span></span>
<span id="cb61-8"><a href="#cb61-8"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(X){</span>
<span id="cb61-9"><a href="#cb61-9"></a>m &lt;-<span class="kw">cov</span>(X)</span>
<span id="cb61-10"><a href="#cb61-10"></a>lambda &lt;-<span class="st"> </span><span class="kw">eigen</span>(m)<span class="op">$</span>values</span>
<span id="cb61-11"><a href="#cb61-11"></a>theta&lt;-<span class="st"> </span>lambda[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda)</span>
<span id="cb61-12"><a href="#cb61-12"></a>}</span>
<span id="cb61-13"><a href="#cb61-13"></a>sigma &lt;-<span class="st"> </span><span class="kw">cov</span>(scor)</span>
<span id="cb61-14"><a href="#cb61-14"></a>s &lt;-<span class="st"> </span><span class="kw">eigen</span>(sigma)</span>
<span id="cb61-15"><a href="#cb61-15"></a>v &lt;-<span class="st"> </span>s<span class="op">$</span>values[<span class="kw">order</span>(<span class="op">-</span>(s<span class="op">$</span>values))]</span>
<span id="cb61-16"><a href="#cb61-16"></a>theta &lt;-<span class="st"> </span>v[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(v) <span class="co">## measures the proportion of variance explained by the first principal component of the original sample.</span></span>
<span id="cb61-17"><a href="#cb61-17"></a>boot &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>B</span>
<span id="cb61-18"><a href="#cb61-18"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</span>
<span id="cb61-19"><a href="#cb61-19"></a>index &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</span>
<span id="cb61-20"><a href="#cb61-20"></a>X_boot &lt;-<span class="st"> </span>X[index,]</span>
<span id="cb61-21"><a href="#cb61-21"></a>boot[i] &lt;-<span class="st"> </span><span class="kw">f</span>(X_boot)</span>
<span id="cb61-22"><a href="#cb61-22"></a>}</span>
<span id="cb61-23"><a href="#cb61-23"></a>theta_hat &lt;-<span class="st"> </span><span class="kw">f</span>(X)</span>
<span id="cb61-24"><a href="#cb61-24"></a>bias.bootstrap &lt;-<span class="st"> </span><span class="kw">mean</span>(boot) <span class="op">-</span><span class="st"> </span>theta_hat <span class="co">## Obtain the bootstrap estimates of bias of θ.hat</span></span>
<span id="cb61-25"><a href="#cb61-25"></a>se.bootstrap &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(boot)) <span class="co">## Obtain the bootstrap estimates of standard error of θ.hat</span></span>
<span id="cb61-26"><a href="#cb61-26"></a><span class="kw">print</span>(theta,<span class="dt">digits =</span> <span class="dv">8</span>)</span></code></pre></div>
<pre><code>## [1] 0.61911504</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="kw">print</span>(bias.bootstrap,<span class="dt">digits =</span> <span class="dv">8</span>)</span></code></pre></div>
<pre><code>## [1] 0.0020850521</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="kw">print</span>(se.bootstrap,<span class="dt">digits =</span> <span class="dv">8</span>)</span></code></pre></div>
<pre><code>## [1] 0.047149043</code></pre>
<p><br />
So:Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat\theta\)</span>(Under B=10000).<br />
<span class="math display">\[
\hat{bias}_B(\hat\theta)=0.0020850521\\
\hat{se}_B(\hat\theta)=0.047149043
\]</span><br />
</p>
</div>
<div id="question-7.8" class="section level2">
<h2>Question 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span>.<br />
</p>
<p><strong>Solution:</strong></p>
<p>Use jackknife to estimate the bias and standard error of <span class="math inline">\(\hat\theta\)</span>.<br />
</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="kw">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb67-3"><a href="#cb67-3"></a>sigma &lt;-<span class="st"> </span><span class="kw">cov</span>(scor)</span>
<span id="cb67-4"><a href="#cb67-4"></a>s &lt;-<span class="st"> </span><span class="kw">eigen</span>(sigma)</span>
<span id="cb67-5"><a href="#cb67-5"></a>v &lt;-<span class="st"> </span>s<span class="op">$</span>values[<span class="kw">order</span>(<span class="op">-</span>(s<span class="op">$</span>values))]</span>
<span id="cb67-6"><a href="#cb67-6"></a>theta &lt;-<span class="st"> </span>v[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(v) <span class="co">## measures the proportion of variance explained by the first principal component of the original sample.</span></span>
<span id="cb67-7"><a href="#cb67-7"></a>n &lt;-<span class="st"> </span><span class="dv">88</span></span>
<span id="cb67-8"><a href="#cb67-8"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb67-9"><a href="#cb67-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb67-10"><a href="#cb67-10"></a>  scor.jack &lt;-<span class="st"> </span>scor[<span class="op">-</span>i, ]</span>
<span id="cb67-11"><a href="#cb67-11"></a>  sigma.hat &lt;-<span class="st"> </span><span class="kw">cov</span>(scor.jack)</span>
<span id="cb67-12"><a href="#cb67-12"></a>  ss &lt;-<span class="st"> </span><span class="kw">eigen</span>(sigma.hat)</span>
<span id="cb67-13"><a href="#cb67-13"></a>  vv &lt;-<span class="st"> </span>ss<span class="op">$</span>values[<span class="kw">order</span>(<span class="op">-</span>(ss<span class="op">$</span>values))]</span>
<span id="cb67-14"><a href="#cb67-14"></a>  theta.hat[i] &lt;-<span class="st"> </span>vv[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(vv)</span>
<span id="cb67-15"><a href="#cb67-15"></a>}</span>
<span id="cb67-16"><a href="#cb67-16"></a>bias.jackknife &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.hat)<span class="op">-</span>theta) <span class="co">## Obtain the jackknife estimates of bias of θ.hat</span></span>
<span id="cb67-17"><a href="#cb67-17"></a>se.jackknife &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.hat<span class="op">-</span>theta)<span class="op">^</span><span class="dv">2</span>)) <span class="co">## Obtain the jackknife estimates of standard error of θ.hat</span></span>
<span id="cb67-18"><a href="#cb67-18"></a><span class="kw">print</span>(theta,<span class="dt">digits =</span> <span class="dv">8</span>)</span></code></pre></div>
<pre><code>## [1] 0.61911504</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="kw">print</span>(bias.jackknife,<span class="dt">digits =</span> <span class="dv">8</span>)</span></code></pre></div>
<pre><code>## [1] 0.0010691389</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="kw">print</span>(se.jackknife,<span class="dt">digits =</span> <span class="dv">8</span>)</span></code></pre></div>
<pre><code>## [1] 0.04955244</code></pre>
<p><br />
So:Use Jackknife to estimate the bias and standard error of <span class="math inline">\(\hat\theta\)</span>.<br />
<span class="math display">\[
\hat{bias}_J(\hat\theta)=0.0010691389\\
\hat{se}_J(\hat\theta)=0.04955244
\]</span><br />
</p>
</div>
<div id="question-7.9" class="section level2">
<h2>Question 7.9</h2>
<p>Refer to Exercise 7.7. Compute 95% percentile and BCa confidence intervals for <span class="math inline">\(\hat\theta\)</span>.<br />
</p>
<p><strong>Solution:</strong></p>
<p>Using the function boot.ci to compute 95% percentile and BCa confidence intervals for <span class="math inline">\(\hat\theta\)</span>.<br />
</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="kw">set.seed</span>(<span class="dv">827</span>)</span>
<span id="cb73-3"><a href="#cb73-3"></a><span class="kw">data</span>(scor, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb73-4"><a href="#cb73-4"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">88</span>)</span>
<span id="cb73-5"><a href="#cb73-5"></a>boot.theta&lt;-<span class="cf">function</span>(X,i){</span>
<span id="cb73-6"><a href="#cb73-6"></a>  sigma.hat &lt;-<span class="st"> </span><span class="kw">cov</span>(X[i,])</span>
<span id="cb73-7"><a href="#cb73-7"></a>  ss &lt;-<span class="st"> </span><span class="kw">eigen</span>(sigma.hat)</span>
<span id="cb73-8"><a href="#cb73-8"></a>  vv &lt;-<span class="st"> </span>ss<span class="op">$</span>values[<span class="kw">order</span>(<span class="op">-</span>(ss<span class="op">$</span>values))]</span>
<span id="cb73-9"><a href="#cb73-9"></a>  theta.hat[i] &lt;-<span class="st"> </span>vv[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(vv)</span>
<span id="cb73-10"><a href="#cb73-10"></a>}</span>
<span id="cb73-11"><a href="#cb73-11"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(scor, <span class="dt">statistic =</span> boot.theta,<span class="dt">R =</span> <span class="dv">2000</span>)</span>
<span id="cb73-12"><a href="#cb73-12"></a><span class="kw">print</span>(boot.obj)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = scor, statistic = boot.theta, R = 2000)
## 
## 
## Bootstrap Statistics :
##     original     bias    std. error
## t1* 0.619115 0.00130222  0.04589157</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="kw">boot.ci</span>(boot.obj,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level     Percentile            BCa          
## 95%   ( 0.5229,  0.7051 )   ( 0.5216,  0.7045 )  
## Calculations and Intervals on Original Scale</code></pre>
<p><br />
So (1)the 95% percentile confidence intervals for <span class="math inline">\(\hat\theta\)</span> is ( 0.5229, 0.7051 ) and (2)the 95% BCa confidence intervals for <span class="math inline">\(\hat\theta\)</span> is ( 0.5216, 0.7045 ).</p>
</div>
<div id="question-7.b" class="section level2">
<h2>Question 7.B</h2>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^2(5)\)</span> distributions (positive skewness).<br />
</p>
<p><strong>Solution(normal population):</strong></p>
<p>Repeat Project 7.A for the sample skewness statistic: estimate the coverage probabilities of (1)the standard normal bootstrap confidence interval, (2)the basic bootstrap confidence interval, and (3)the percentile confidence interval. Sample from a normal population and check the empirical coverage rates for the sample skewness statistic.Find (i)the proportion of times that the confidence intervals miss on the left, and (ii)the porportion of times that the confidence intervals miss on the right.<br />
</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="kw">set.seed</span>(<span class="dv">827</span>)</span>
<span id="cb77-3"><a href="#cb77-3"></a><span class="co">## computes the sample skewness.</span></span>
<span id="cb77-4"><a href="#cb77-4"></a>skewness &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) {</span>
<span id="cb77-5"><a href="#cb77-5"></a>  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x[i])</span>
<span id="cb77-6"><a href="#cb77-6"></a>  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb77-7"><a href="#cb77-7"></a>  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb77-8"><a href="#cb77-8"></a>  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb77-9"><a href="#cb77-9"></a>}</span>
<span id="cb77-10"><a href="#cb77-10"></a>s &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co">## normal populations (skewness=0)</span></span>
<span id="cb77-11"><a href="#cb77-11"></a>n &lt;-<span class="st"> </span><span class="dv">20</span> <span class="co">## the size of sample</span></span>
<span id="cb77-12"><a href="#cb77-12"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb77-13"><a href="#cb77-13"></a>normal.norm &lt;-<span class="st"> </span>normal.basic &lt;-<span class="st"> </span>normal.perc &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb77-14"><a href="#cb77-14"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb77-15"><a href="#cb77-15"></a>  data.normal &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb77-16"><a href="#cb77-16"></a>  normal.ske &lt;-<span class="st"> </span><span class="kw">boot</span>(data.normal, <span class="dt">statistic =</span> skewness, <span class="dt">R=</span><span class="dv">1000</span>)</span>
<span id="cb77-17"><a href="#cb77-17"></a>  normal &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(normal.ske, <span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb77-18"><a href="#cb77-18"></a>  normal.norm[i,] &lt;-<span class="st"> </span>normal<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb77-19"><a href="#cb77-19"></a>  normal.basic[i,] &lt;-<span class="st"> </span>normal<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb77-20"><a href="#cb77-20"></a>  normal.perc[i,] &lt;-<span class="st"> </span>normal<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb77-21"><a href="#cb77-21"></a>}</span>
<span id="cb77-22"><a href="#cb77-22"></a><span class="co">## Calculate the coverage probability of a normal distribution</span></span>
<span id="cb77-23"><a href="#cb77-23"></a>    norm &lt;-<span class="st"> </span><span class="kw">mean</span>(normal.norm[,<span class="dv">1</span>] <span class="op">&lt;=</span><span class="st"> </span>s <span class="op">&amp;</span><span class="st"> </span>normal.norm[,<span class="dv">2</span>] <span class="op">&gt;=</span><span class="st"> </span>s)</span>
<span id="cb77-24"><a href="#cb77-24"></a>    basic &lt;-<span class="st"> </span><span class="kw">mean</span>(normal.basic[,<span class="dv">1</span>] <span class="op">&lt;=</span><span class="st"> </span>s <span class="op">&amp;</span><span class="st"> </span>normal.basic[,<span class="dv">2</span>] <span class="op">&gt;=</span><span class="st"> </span>s)</span>
<span id="cb77-25"><a href="#cb77-25"></a>    perc &lt;-<span class="st"> </span><span class="kw">mean</span>(normal.perc[,<span class="dv">1</span>] <span class="op">&lt;=</span><span class="st"> </span>s <span class="op">&amp;</span><span class="st"> </span>normal.perc[,<span class="dv">2</span>] <span class="op">&gt;=</span><span class="st"> </span>s)</span>
<span id="cb77-26"><a href="#cb77-26"></a><span class="co">## (i)Calculate the probability of the left side of the normal distribution</span></span>
<span id="cb77-27"><a href="#cb77-27"></a>   norm.left &lt;-<span class="st"> </span><span class="kw">mean</span>(normal.norm[,<span class="dv">1</span>] <span class="op">&gt;=</span><span class="st"> </span>s )</span>
<span id="cb77-28"><a href="#cb77-28"></a>    basic.left &lt;-<span class="st"> </span><span class="kw">mean</span>(normal.basic[,<span class="dv">1</span>] <span class="op">&gt;=</span><span class="st"> </span>s )</span>
<span id="cb77-29"><a href="#cb77-29"></a>    perc.left &lt;-<span class="st"> </span><span class="kw">mean</span>(normal.perc[,<span class="dv">1</span>] <span class="op">&gt;=</span>s )</span>
<span id="cb77-30"><a href="#cb77-30"></a><span class="co">## (ii)Calculate the probability of the right side of the normal distribution</span></span>
<span id="cb77-31"><a href="#cb77-31"></a>   norm.right &lt;-<span class="st"> </span><span class="kw">mean</span>(normal.norm[,<span class="dv">2</span>] <span class="op">&lt;=</span><span class="st"> </span>s )</span>
<span id="cb77-32"><a href="#cb77-32"></a>    basic.right &lt;-<span class="st"> </span><span class="kw">mean</span>(normal.basic[,<span class="dv">2</span>] <span class="op">&lt;=</span><span class="st"> </span>s )</span>
<span id="cb77-33"><a href="#cb77-33"></a>    perc.right &lt;-<span class="st"> </span><span class="kw">mean</span>(normal.perc[,<span class="dv">2</span>] <span class="op">&lt;=</span><span class="st"> </span>s)</span>
<span id="cb77-34"><a href="#cb77-34"></a>Distribution&lt;-<span class="st">&quot;N(0,25)&quot;</span></span>
<span id="cb77-35"><a href="#cb77-35"></a>Type &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>)</span>
<span id="cb77-36"><a href="#cb77-36"></a>Left &lt;-<span class="st"> </span><span class="kw">c</span>(norm.left, basic.left,perc.left)</span>
<span id="cb77-37"><a href="#cb77-37"></a>Right &lt;-<span class="st"> </span><span class="kw">c</span>(norm.right, basic.right, perc.right)</span>
<span id="cb77-38"><a href="#cb77-38"></a>P.coverage &lt;-<span class="st"> </span><span class="kw">c</span>(norm,basic,perc)</span>
<span id="cb77-39"><a href="#cb77-39"></a>result &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Distribution, Type, Left, Right, P.coverage)</span>
<span id="cb77-40"><a href="#cb77-40"></a>knitr<span class="op">::</span><span class="kw">kable</span>(result) </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Distribution</th>
<th align="left">Type</th>
<th align="right">Left</th>
<th align="right">Right</th>
<th align="right">P.coverage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N(0,25)</td>
<td align="left">norm</td>
<td align="right">0.042</td>
<td align="right">0.064</td>
<td align="right">0.894</td>
</tr>
<tr class="even">
<td align="left">N(0,25)</td>
<td align="left">basic</td>
<td align="right">0.058</td>
<td align="right">0.061</td>
<td align="right">0.881</td>
</tr>
<tr class="odd">
<td align="left">N(0,25)</td>
<td align="left">perc</td>
<td align="right">0.009</td>
<td align="right">0.021</td>
<td align="right">0.970</td>
</tr>
</tbody>
</table>
<p><br />
After repeating Project 7.A for the sample skewness statistic,we can find that in the case of the size of sample is 20, the coverage probabilities of the 3 types of confidence intervals ((1)the standard normal bootstrap confidence interval, (2)the basic bootstrap confidence interval, and (3)the percentile confidence interval.) are very close to 0.9 in the normal populations (skewness 0).And we can get the probability that (i)the confidence intervals miss on the left, and (ii)the probability that the confidence intervals miss on the right from the table.<br />
</p>
<p><strong>Solution(chisq with 5 freedom distribution):</strong></p>
<p>Repeat Project 7.A for the sample skewness statistic: estimate the coverage probabilities of (1)the standard normal bootstrap confidence interval, (2)the basic bootstrap confidence interval, and (3)the percentile confidence interval. Sample from a <span class="math inline">\(\chi^2(5)\)</span> distribution and check the empirical coverage rates for the sample skewness statistic.Find (i)the proportion of times that the confidence intervals miss on the left, and (ii)the porportion of times that the confidence intervals miss on the right.<br />
</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="kw">set.seed</span>(<span class="dv">827</span>)</span>
<span id="cb78-3"><a href="#cb78-3"></a><span class="co">## computes the sample skewness.</span></span>
<span id="cb78-4"><a href="#cb78-4"></a>skewness &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) {</span>
<span id="cb78-5"><a href="#cb78-5"></a>  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x[i])</span>
<span id="cb78-6"><a href="#cb78-6"></a>  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb78-7"><a href="#cb78-7"></a>  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb78-8"><a href="#cb78-8"></a>  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb78-9"><a href="#cb78-9"></a>}</span>
<span id="cb78-10"><a href="#cb78-10"></a>s&lt;-<span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>) <span class="co">## chisq with 5 freedom distribution (positive skewness=1.6).</span></span>
<span id="cb78-11"><a href="#cb78-11"></a>n&lt;-<span class="dv">20</span> <span class="co">## the size of sample</span></span>
<span id="cb78-12"><a href="#cb78-12"></a>m&lt;-<span class="dv">1000</span></span>
<span id="cb78-13"><a href="#cb78-13"></a>chisq.norm&lt;-chisq.basic&lt;-chisq.perc&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb78-14"><a href="#cb78-14"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb78-15"><a href="#cb78-15"></a>  data.chisq&lt;-<span class="kw">rchisq</span>(n,<span class="dv">5</span>)</span>
<span id="cb78-16"><a href="#cb78-16"></a>  chisq.ske&lt;-<span class="kw">boot</span>(data.chisq,<span class="dt">statistic=</span>skewness, <span class="dt">R=</span><span class="dv">1000</span>)</span>
<span id="cb78-17"><a href="#cb78-17"></a>  chisq&lt;-<span class="st"> </span><span class="kw">boot.ci</span>(chisq.ske,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb78-18"><a href="#cb78-18"></a>  chisq.norm[i,]&lt;-chisq<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>];</span>
<span id="cb78-19"><a href="#cb78-19"></a>  chisq.basic[i,]&lt;-chisq<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>];</span>
<span id="cb78-20"><a href="#cb78-20"></a>  chisq.perc[i,]&lt;-chisq<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>];</span>
<span id="cb78-21"><a href="#cb78-21"></a>}</span>
<span id="cb78-22"><a href="#cb78-22"></a><span class="co">## Calculate the coverage probability of the chi-square distribution.</span></span>
<span id="cb78-23"><a href="#cb78-23"></a>    norm &lt;-<span class="st"> </span><span class="kw">mean</span>(chisq.norm[,<span class="dv">1</span>] <span class="op">&lt;=</span><span class="st"> </span>s <span class="op">&amp;</span><span class="st"> </span>chisq.norm[,<span class="dv">2</span>] <span class="op">&gt;=</span><span class="st"> </span>s)</span>
<span id="cb78-24"><a href="#cb78-24"></a>    basic &lt;-<span class="st"> </span><span class="kw">mean</span>(chisq.basic[,<span class="dv">1</span>] <span class="op">&lt;=</span><span class="st"> </span>s <span class="op">&amp;</span><span class="st"> </span>chisq.basic[,<span class="dv">2</span>] <span class="op">&gt;=</span><span class="st"> </span>s)</span>
<span id="cb78-25"><a href="#cb78-25"></a>    perc &lt;-<span class="st"> </span><span class="kw">mean</span>(chisq.perc[,<span class="dv">1</span>] <span class="op">&lt;=</span><span class="st"> </span>s <span class="op">&amp;</span><span class="st"> </span>chisq.perc[,<span class="dv">2</span>] <span class="op">&gt;=</span><span class="st"> </span>s)</span>
<span id="cb78-26"><a href="#cb78-26"></a><span class="co">## (i) Calculate the probability of the left side of the chi-square distribution.</span></span>
<span id="cb78-27"><a href="#cb78-27"></a>    norm.left &lt;-<span class="st"> </span><span class="kw">mean</span>(chisq.norm[,<span class="dv">1</span>] <span class="op">&gt;=</span><span class="st"> </span>s )</span>
<span id="cb78-28"><a href="#cb78-28"></a>    basic.left &lt;-<span class="kw">mean</span>(chisq.basic[,<span class="dv">1</span>] <span class="op">&gt;=</span><span class="st"> </span>s )</span>
<span id="cb78-29"><a href="#cb78-29"></a>    perc.left &lt;-<span class="st"> </span><span class="kw">mean</span>(chisq.perc[,<span class="dv">1</span>] <span class="op">&gt;=</span>s )</span>
<span id="cb78-30"><a href="#cb78-30"></a><span class="co">## (ii) Calculate the probability of the right side of the chi-square distribution.</span></span>
<span id="cb78-31"><a href="#cb78-31"></a>    norm.right &lt;-<span class="st"> </span><span class="kw">mean</span>(chisq.norm[,<span class="dv">2</span>] <span class="op">&lt;=</span><span class="st"> </span>s )</span>
<span id="cb78-32"><a href="#cb78-32"></a>    basic.right &lt;-<span class="st"> </span><span class="kw">mean</span>(chisq.basic[,<span class="dv">2</span>] <span class="op">&lt;=</span><span class="st"> </span>s )</span>
<span id="cb78-33"><a href="#cb78-33"></a>    perc.right &lt;-<span class="st"> </span><span class="kw">mean</span>(chisq.perc[,<span class="dv">2</span>] <span class="op">&lt;=</span><span class="st"> </span>s)</span>
<span id="cb78-34"><a href="#cb78-34"></a>Distribution&lt;-<span class="st">&quot;chisq(5)&quot;</span></span>
<span id="cb78-35"><a href="#cb78-35"></a>Type &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>)</span>
<span id="cb78-36"><a href="#cb78-36"></a>Left &lt;-<span class="st"> </span><span class="kw">c</span>(norm.left, basic.left,perc.left)</span>
<span id="cb78-37"><a href="#cb78-37"></a>Right &lt;-<span class="st"> </span><span class="kw">c</span>(norm.right, basic.right, perc.right)</span>
<span id="cb78-38"><a href="#cb78-38"></a>P.coverage &lt;-<span class="st"> </span><span class="kw">c</span>(norm,basic,perc)</span>
<span id="cb78-39"><a href="#cb78-39"></a>result &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Distribution, Type, Left, Right, P.coverage)</span>
<span id="cb78-40"><a href="#cb78-40"></a>knitr<span class="op">::</span><span class="kw">kable</span>(result) </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Distribution</th>
<th align="left">Type</th>
<th align="right">Left</th>
<th align="right">Right</th>
<th align="right">P.coverage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">chisq(5)</td>
<td align="left">norm</td>
<td align="right">0.019</td>
<td align="right">0.247</td>
<td align="right">0.734</td>
</tr>
<tr class="even">
<td align="left">chisq(5)</td>
<td align="left">basic</td>
<td align="right">0.034</td>
<td align="right">0.255</td>
<td align="right">0.711</td>
</tr>
<tr class="odd">
<td align="left">chisq(5)</td>
<td align="left">perc</td>
<td align="right">0.000</td>
<td align="right">0.278</td>
<td align="right">0.722</td>
</tr>
</tbody>
</table>
<p><br />
After repeating Project 7.A for the sample skewness statistic,we can find that in the case of the size of sample is 20, the coverage probabilities of the 3 types of confidence intervals ((1)the standard normal bootstrap confidence interval, (2)the basic bootstrap confidence interval, and (3)the percentile confidence interval.) are very close to 0.7 in the <span class="math inline">\(\chi^2(5)\)</span> distribution(positive skewness).And we can get the probability that (i)the confidence intervals miss on the left, and (ii)the probability that the confidence intervals miss on the right from the table.<br />
Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^2(5)\)</span> distributions (positive skewness).<br />
we can find that in the case of the size of sample is 20, the coverage probabilities of the 3 types of confidence intervals are very close to 0.9 in the normal distribution (skewness 0) and are very close to 0.7 in <span class="math inline">\(\chi^2(5)\)</span> distribution (positive skewness).</p>
</div>
<div id="title-a-21010-2021-11-04" class="section level2">
<h2>title: “A-21010-2021-11-04”</h2>
</div>
<div id="exercise-8.2-page-242statistical-computing-with-r." class="section level2">
<h2>Exercise 8.2 (page 242,Statistical Computing with R).</h2>
</div>
<div id="design-experiments-for-evaluating-the-performance-of-the-nnenergy-and-ball-methods-in-various-situations." class="section level2">
<h2>Design experiments for evaluating the performance of the NN,energy, and ball methods in various situations.</h2>
<p><em>Unequal variances and equal expectations.<br />
</em>Unequal variances and unequal expectations.<br />
<em>Non-normal distributions: t distribution with 1 df (heavy-tailed distribtion), bimodel distribution (mixture of two normal distribtions).<br />
</em>Unbalanced samples (say, 1 case versus 10 controls).<br />
NOTE: The parameters should be chosen such that the powers are distinguishable (say,range from 0.3 to 0.8).</p>
</div>
<div id="question8.2" class="section level2">
<h2>Question8.2</h2>
<p>Implement the bivariate Spearman rank correlation test for independence[255] as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method = “spearman”. Compare the achieved significance level of the permutation test with p-value reported by cor.test on the same samples.</p>
<p><strong>Solution:</strong> The Spearman’s rank correlation test statistic is:<br />
<span class="math display">\[
\rho=\frac{\sum_{i=1}^{n}R(x_i)R(y_i)-n(\frac{n+1}{2})^2}{\sqrt{\sum_{i=1}^{n}R(x_i)^2-n(\frac{n+1}{2})^2}\sqrt{\sum_{i=1}^{n}R(y_i)^2-n(\frac{n+1}{2})^2}}
\]</span><br />
where <span class="math inline">\(R(x)\)</span> and <span class="math inline">\(R(y)\)</span> are the ranks of a pair of variables (<span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>) each containing n observations.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="kw">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb79-2"><a href="#cb79-2"></a>data &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(iris[<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</span>
<span id="cb79-3"><a href="#cb79-3"></a>x &lt;-<span class="st"> </span>data[ , <span class="dv">3</span><span class="op">:</span><span class="dv">4</span>]</span>
<span id="cb79-4"><a href="#cb79-4"></a>y &lt;-<span class="st"> </span>data[ , <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</span>
<span id="cb79-5"><a href="#cb79-5"></a>R &lt;-<span class="st"> </span><span class="dv">999</span></span>
<span id="cb79-6"><a href="#cb79-6"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb79-7"><a href="#cb79-7"></a>K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">200</span></span>
<span id="cb79-8"><a href="#cb79-8"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb79-9"><a href="#cb79-9"></a>permutation &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</span>
<span id="cb79-10"><a href="#cb79-10"></a>cor0 &lt;-<span class="st"> </span><span class="kw">cor.test</span>(x,y)<span class="op">$</span>statistic</span>
<span id="cb79-11"><a href="#cb79-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</span>
<span id="cb79-12"><a href="#cb79-12"></a>  k &lt;-<span class="st"> </span><span class="kw">sample</span>(K,<span class="dt">size =</span> n,<span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb79-13"><a href="#cb79-13"></a>  x1 &lt;-<span class="st"> </span>z[k]</span>
<span id="cb79-14"><a href="#cb79-14"></a>  y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k]</span>
<span id="cb79-15"><a href="#cb79-15"></a>  permutation[i] &lt;-<span class="st"> </span><span class="kw">cor.test</span>(x1,y1)<span class="op">$</span>statistic</span>
<span id="cb79-16"><a href="#cb79-16"></a>}</span>
<span id="cb79-17"><a href="#cb79-17"></a>permutation.p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(cor0,permutation))<span class="op">&gt;=</span><span class="kw">abs</span>(cor0))</span>
<span id="cb79-18"><a href="#cb79-18"></a>permutation.p</span></code></pre></div>
<pre><code>## [1] 0.001</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="kw">cor.test</span>(x, y,<span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  x and y
## t = 21.463, df = 98, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.8661245 0.9373022
## sample estimates:
##      cor 
## 0.908061</code></pre>
<p><br />
It can be seen that the correlation coefficient between the two variate is 0.908061, and the test p-value is 2.2e-16&lt;0.05. So x and y are related, not independent.<br />
</p>
</div>
<div id="questiondesign-experiments-for-evaluating-the-performance-of-the-nn-energy-and-ball-methods-in-various-situations." class="section level2">
<h2>Question:Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</h2>
<p><em>Unequal variances and equal expectations.<br />
</em>Unequal variances and unequal expectations.<br />
<em>Non-normal distributions: t distribution with 1 df (heavy-tailed distribtion), bimodel distribution (mixture of two normal distribtions).<br />
</em>Unbalanced samples (say, 1 case versus 10 controls).<br />
NOTE: The parameters should be chosen such that the powers are distinguishable (say,range from 0.3 to 0.8).</p>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="kw">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb83-2"><a href="#cb83-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb83-3"><a href="#cb83-3"></a><span class="kw">library</span>(RANN)</span>
<span id="cb83-4"><a href="#cb83-4"></a><span class="kw">library</span>(energy)</span>
<span id="cb83-5"><a href="#cb83-5"></a><span class="kw">library</span>(Ball)</span>
<span id="cb83-6"><a href="#cb83-6"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb83-7"><a href="#cb83-7"></a><span class="co">## write the function of the NN test.</span></span>
<span id="cb83-8"><a href="#cb83-8"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k){</span>
<span id="cb83-9"><a href="#cb83-9"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb83-10"><a href="#cb83-10"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb83-11"><a href="#cb83-11"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb83-12"><a href="#cb83-12"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) </span>
<span id="cb83-13"><a href="#cb83-13"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb83-14"><a href="#cb83-14"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb83-15"><a href="#cb83-15"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>)</span>
<span id="cb83-16"><a href="#cb83-16"></a>  i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb83-17"><a href="#cb83-17"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb83-18"><a href="#cb83-18"></a>} <span class="co">## the function of NN method.</span></span>
<span id="cb83-19"><a href="#cb83-19"></a>NN_test &lt;-<span class="st"> </span><span class="cf">function</span>(x,y,<span class="dt">NumR=</span><span class="dv">999</span>,<span class="dt">k=</span><span class="dv">3</span>){</span>
<span id="cb83-20"><a href="#cb83-20"></a>N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(x), <span class="kw">length</span>(y)) </span>
<span id="cb83-21"><a href="#cb83-21"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb83-22"><a href="#cb83-22"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn, <span class="dt">R =</span> NumR, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> N,<span class="dt">k=</span>k)</span>
<span id="cb83-23"><a href="#cb83-23"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t) </span>
<span id="cb83-24"><a href="#cb83-24"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb83-25"><a href="#cb83-25"></a><span class="kw">return</span>(p.value)</span>
<span id="cb83-26"><a href="#cb83-26"></a>}</span>
<span id="cb83-27"><a href="#cb83-27"></a><span class="co">## Energy test</span></span>
<span id="cb83-28"><a href="#cb83-28"></a>Energy_test &lt;-<span class="st"> </span><span class="cf">function</span>(x,y,<span class="dt">NumR=</span><span class="dv">999</span>){</span>
<span id="cb83-29"><a href="#cb83-29"></a>N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(x), <span class="kw">length</span>(y)) </span>
<span id="cb83-30"><a href="#cb83-30"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb83-31"><a href="#cb83-31"></a>boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z, <span class="dt">sizes=</span>N, <span class="dt">R=</span>NumR) </span>
<span id="cb83-32"><a href="#cb83-32"></a>p.value &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb83-33"><a href="#cb83-33"></a><span class="kw">return</span>(p.value)</span>
<span id="cb83-34"><a href="#cb83-34"></a>}</span>
<span id="cb83-35"><a href="#cb83-35"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb83-36"><a href="#cb83-36"></a><span class="co">## Ball test: ball statistic test for equal distributions can be directly achieved by  Ball package.</span></span></code></pre></div>
<p><br />
</p>
<p><strong>Unequal variances and equal expectations</strong></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="kw">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb84-2"><a href="#cb84-2"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span>; <span class="co">## number of permutation tests</span></span>
<span id="cb84-3"><a href="#cb84-3"></a>k&lt;-<span class="dv">3</span>; <span class="co">## boot parameter</span></span>
<span id="cb84-4"><a href="#cb84-4"></a>p&lt;-<span class="dv">2</span>; <span class="co">## dimension of data</span></span>
<span id="cb84-5"><a href="#cb84-5"></a>mu &lt;-<span class="st"> </span><span class="dv">0</span>; </span>
<span id="cb84-6"><a href="#cb84-6"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; <span class="co">## the sample size of x and y</span></span>
<span id="cb84-7"><a href="#cb84-7"></a>R&lt;-<span class="dv">999</span>; <span class="co">## boot parameter</span></span>
<span id="cb84-8"><a href="#cb84-8"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span> </span>
<span id="cb84-9"><a href="#cb84-9"></a>sigma2 &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb84-10"><a href="#cb84-10"></a><span class="co">## x~N(0,1) 50 y~N(0,4) 50</span></span>
<span id="cb84-11"><a href="#cb84-11"></a>p.values1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>) </span>
<span id="cb84-12"><a href="#cb84-12"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ </span>
<span id="cb84-13"><a href="#cb84-13"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,mu,sigma1)</span>
<span id="cb84-14"><a href="#cb84-14"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,mu,sigma2)</span>
<span id="cb84-15"><a href="#cb84-15"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y) </span>
<span id="cb84-16"><a href="#cb84-16"></a>p.values1[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">NN_test</span>(x,y,R,k) </span>
<span id="cb84-17"><a href="#cb84-17"></a>p.values1[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">Energy_test</span>(x,y,R)</span>
<span id="cb84-18"><a href="#cb84-18"></a>p.values1[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(x,y,<span class="dt">R=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">1212</span>)<span class="op">$</span>p.value </span>
<span id="cb84-19"><a href="#cb84-19"></a>}</span>
<span id="cb84-20"><a href="#cb84-20"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values1<span class="op">&lt;</span>alpha)</span>
<span id="cb84-21"><a href="#cb84-21"></a>power &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>),pow)</span>
<span id="cb84-22"><a href="#cb84-22"></a>power</span></code></pre></div>
<pre><code>##   methods   pow
## 1      NN 0.571
## 2  energy 0.771
## 3    Ball 0.904</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="kw">ggplot</span>(power,<span class="kw">aes</span>(methods,pow))<span class="op">+</span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">&#39;lightblue&#39;</span>)<span class="op">+</span><span class="kw">coord_flip</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
<strong>Conclusion:</strong> Unequal variances and equal expectations:The power of Ball method is better than NN and energy methods.<br />
</p>
<p><strong>Unequal variances and unequal expectations</strong></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="kw">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb87-2"><a href="#cb87-2"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span>; <span class="co">## number of permutation tests</span></span>
<span id="cb87-3"><a href="#cb87-3"></a>k&lt;-<span class="dv">3</span>; <span class="co">## boot parameter</span></span>
<span id="cb87-4"><a href="#cb87-4"></a>p&lt;-<span class="dv">2</span>; <span class="co">## dimension of data</span></span>
<span id="cb87-5"><a href="#cb87-5"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; <span class="co">## the sample size of x and y</span></span>
<span id="cb87-6"><a href="#cb87-6"></a>R&lt;-<span class="dv">999</span>; <span class="co">## boot parameter</span></span>
<span id="cb87-7"><a href="#cb87-7"></a>mu &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb87-8"><a href="#cb87-8"></a>sd &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb87-9"><a href="#cb87-9"></a><span class="co">#x~N(0,1) 50  y~N(0.5,2.25) 50</span></span>
<span id="cb87-10"><a href="#cb87-10"></a>p.values2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>) </span>
<span id="cb87-11"><a href="#cb87-11"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb87-12"><a href="#cb87-12"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p),<span class="dt">ncol=</span>p)</span>
<span id="cb87-13"><a href="#cb87-13"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dt">mean=</span>mu,<span class="dt">sd=</span>sd),<span class="dt">ncol=</span>p)</span>
<span id="cb87-14"><a href="#cb87-14"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb87-15"><a href="#cb87-15"></a>p.values2[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">NN_test</span>(x,y,R,k) </span>
<span id="cb87-16"><a href="#cb87-16"></a>p.values2[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">Energy_test</span>(x,y,R)</span>
<span id="cb87-17"><a href="#cb87-17"></a>p.values2[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(x,y,<span class="dt">R=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">1212</span>)<span class="op">$</span>p.value </span>
<span id="cb87-18"><a href="#cb87-18"></a>}</span>
<span id="cb87-19"><a href="#cb87-19"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values2<span class="op">&lt;</span>alpha)</span>
<span id="cb87-20"><a href="#cb87-20"></a>power &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>),pow)</span>
<span id="cb87-21"><a href="#cb87-21"></a>power</span></code></pre></div>
<pre><code>##   methods   pow
## 1      NN 0.469
## 2  energy 0.949
## 3    Ball 0.960</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="kw">ggplot</span>(power,<span class="kw">aes</span>(methods,pow))<span class="op">+</span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">&#39;lightblue&#39;</span>)<span class="op">+</span><span class="kw">coord_flip</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
<strong>Conclusion:</strong> Unequal variances and unequal expectations:The power of Ball method is better than NN and energy methods.<br />
</p>
<p><strong>Non-normal distributions: t distribution with 1 df (heavy-tailed distribtion), bimodel distribution (mixture of two normal distribtions)</strong></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="kw">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb90-2"><a href="#cb90-2"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span>; <span class="co">## number of permutation tests</span></span>
<span id="cb90-3"><a href="#cb90-3"></a>k&lt;-<span class="dv">3</span>; <span class="co">## boot parameter</span></span>
<span id="cb90-4"><a href="#cb90-4"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; <span class="co">## the sample size of x and y</span></span>
<span id="cb90-5"><a href="#cb90-5"></a>df=<span class="dv">1</span> <span class="co">## freedom of t distribution(heavy-tailed distribtion)</span></span>
<span id="cb90-6"><a href="#cb90-6"></a>R&lt;-<span class="dv">999</span>;<span class="co">## boot parameter</span></span>
<span id="cb90-7"><a href="#cb90-7"></a>p=<span class="fl">0.4</span></span>
<span id="cb90-8"><a href="#cb90-8"></a>mu1 =<span class="op">-</span><span class="dv">1</span></span>
<span id="cb90-9"><a href="#cb90-9"></a>mu2 =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb90-10"><a href="#cb90-10"></a>sigma1 =<span class="dv">1</span></span>
<span id="cb90-11"><a href="#cb90-11"></a>sigma2 =<span class="dv">2</span></span>
<span id="cb90-12"><a href="#cb90-12"></a><span class="co">#x~t1 50  y~0.3N(-1,1)+0.7N(1,2) 50</span></span>
<span id="cb90-13"><a href="#cb90-13"></a>p.values3 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>) </span>
<span id="cb90-14"><a href="#cb90-14"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ </span>
<span id="cb90-15"><a href="#cb90-15"></a>x &lt;-<span class="st"> </span><span class="kw">rt</span>(n1,<span class="dt">df=</span>df)</span>
<span id="cb90-16"><a href="#cb90-16"></a>y &lt;-<span class="st"> </span><span class="fl">0.3</span> <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(n2,mu1,sigma1) <span class="op">+</span><span class="st"> </span><span class="fl">0.7</span><span class="op">*</span><span class="kw">rnorm</span>(n2,mu2,sigma2)</span>
<span id="cb90-17"><a href="#cb90-17"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y) </span>
<span id="cb90-18"><a href="#cb90-18"></a>p.values3[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">NN_test</span>(x,y,R,k) </span>
<span id="cb90-19"><a href="#cb90-19"></a>p.values3[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">Energy_test</span>(x,y,R)</span>
<span id="cb90-20"><a href="#cb90-20"></a>p.values3[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(x,y,<span class="dt">R=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">1212</span>)<span class="op">$</span>p.value </span>
<span id="cb90-21"><a href="#cb90-21"></a>}</span>
<span id="cb90-22"><a href="#cb90-22"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values3<span class="op">&lt;</span>alpha)</span>
<span id="cb90-23"><a href="#cb90-23"></a>power &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>),pow)</span>
<span id="cb90-24"><a href="#cb90-24"></a>power</span></code></pre></div>
<pre><code>##   methods   pow
## 1      NN 0.284
## 2  energy 0.570
## 3    Ball 0.391</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="kw">ggplot</span>(power,<span class="kw">aes</span>(methods,pow))<span class="op">+</span><span class="kw">geom_col</span>(<span class="dt">fill =</span><span class="st">&#39;lightblue&#39;</span>)<span class="op">+</span><span class="kw">coord_flip</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
<strong>Conclusion:</strong> Non-normal distributions: t distribution with 1 df (heavy-tailed distribtion), bimodel distribution (mixture of two normal distribtions):The power of energy method is better than NN and Ball methods.<br />
</p>
<p><strong>Unbalanced samples (say, 1 case versus 10 controls)</strong></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="kw">set.seed</span>(<span class="dv">122</span>)</span>
<span id="cb93-2"><a href="#cb93-2"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span>; <span class="co">## number of permutation tests</span></span>
<span id="cb93-3"><a href="#cb93-3"></a>k&lt;-<span class="dv">3</span>; <span class="co">## boot parameter</span></span>
<span id="cb93-4"><a href="#cb93-4"></a>n1 &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb93-5"><a href="#cb93-5"></a>n2 &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb93-6"><a href="#cb93-6"></a>R&lt;-<span class="dv">999</span>; <span class="co">## boot parameter</span></span>
<span id="cb93-7"><a href="#cb93-7"></a>mu1 =<span class="op">-</span><span class="dv">1</span></span>
<span id="cb93-8"><a href="#cb93-8"></a>mu2 =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb93-9"><a href="#cb93-9"></a>sigma1 =<span class="dv">1</span></span>
<span id="cb93-10"><a href="#cb93-10"></a>sigma2 =<span class="dv">2</span></span>
<span id="cb93-11"><a href="#cb93-11"></a><span class="co">#x~N(-1,1) 100  y~N(1,2) 10</span></span>
<span id="cb93-12"><a href="#cb93-12"></a>p.values4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>) </span>
<span id="cb93-13"><a href="#cb93-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ </span>
<span id="cb93-14"><a href="#cb93-14"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,mu1,sigma1)</span>
<span id="cb93-15"><a href="#cb93-15"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,mu2,sigma2)</span>
<span id="cb93-16"><a href="#cb93-16"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb93-17"><a href="#cb93-17"></a>p.values4[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">NN_test</span>(x,y,R,k) </span>
<span id="cb93-18"><a href="#cb93-18"></a>p.values4[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">Energy_test</span>(x,y,R)</span>
<span id="cb93-19"><a href="#cb93-19"></a>p.values4[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(x,y,<span class="dt">R=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">1212</span>)<span class="op">$</span>p.value </span>
<span id="cb93-20"><a href="#cb93-20"></a>}</span>
<span id="cb93-21"><a href="#cb93-21"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values4<span class="op">&lt;</span>alpha)</span>
<span id="cb93-22"><a href="#cb93-22"></a>power &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>),pow)</span>
<span id="cb93-23"><a href="#cb93-23"></a>power</span></code></pre></div>
<pre><code>##   methods   pow
## 1      NN 0.544
## 2  energy 0.774
## 3    Ball 0.506</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="kw">ggplot</span>(power,<span class="kw">aes</span>(methods,pow))<span class="op">+</span><span class="kw">geom_col</span>(<span class="dt">fill =</span><span class="st">&#39;lightblue&#39;</span>)<span class="op">+</span><span class="kw">coord_flip</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
<strong>Conclusion:</strong> Unbalanced samples (say, 1 case versus 10 controls):The power of energy method is better than NN and Ball methods.<br />
</p>
</div>
<div id="title-a-21010-2021-11-11" class="section level2">
<h2>title: “A-21010-2021-11-11”</h2>
</div>
<div id="exercise-9.3-and-9.8-pages-277-278statistical-computing-with-r." class="section level2">
<h2>Exercise 9.3 and 9.8 (pages 277-278,Statistical Computing with R).<br />
</h2>
</div>
<div id="for-each-of-the-above-exercise-use-the-gelman-rubin-method-to-monitor-convergence-of-the-chain-and-run-the-chain-until-it-converges-approximately-to-the-target-distribution-according-to-hatr1.2." class="section level2">
<h2>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.<br />
</h2>
</div>
<div id="question-9.3" class="section level2">
<h2>Question 9.3</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a Cauchy<span class="math inline">\((\theta, \eta)\)</span> distribution has density function<br />
<span class="math display">\[
f(x)=\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)},-\infty&lt;x&lt;\infty,\theta&gt;0.
\]</span><br />
The standard Cauchy has the Cauchy<span class="math inline">\((\theta = 1, \eta = 0)\)</span> density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)</p>
<p><strong>Solution:</strong></p>
<p>Because the standard Cauchy density is equal to the Student t density with one degree of freedom, try the Student t distribution with one degree of freedom for the proposal distribution.<br />
</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="kw">set.seed</span>(<span class="dv">2029</span>)</span>
<span id="cb96-2"><a href="#cb96-2"></a>m &lt;-<span class="st"> </span><span class="dv">3000</span> <span class="co">## Sample size</span></span>
<span id="cb96-3"><a href="#cb96-3"></a>x &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb96-4"><a href="#cb96-4"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)</span>
<span id="cb96-5"><a href="#cb96-5"></a>theta=<span class="dv">1</span></span>
<span id="cb96-6"><a href="#cb96-6"></a>eta=<span class="dv">0</span></span>
<span id="cb96-7"><a href="#cb96-7"></a>x[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb96-8"><a href="#cb96-8"></a>k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb96-9"><a href="#cb96-9"></a></span>
<span id="cb96-10"><a href="#cb96-10"></a><span class="co">## The following function evaluates the Cauchy(0,1) density.</span></span>
<span id="cb96-11"><a href="#cb96-11"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">theta=</span><span class="dv">1</span>, <span class="dt">eta=</span><span class="dv">0</span>){</span>
<span id="cb96-12"><a href="#cb96-12"></a>  out &lt;-<span class="st"> </span>theta <span class="op">/</span>(pi <span class="op">*</span><span class="st"> </span>(theta<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(x<span class="op">-</span>eta)<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb96-13"><a href="#cb96-13"></a>  <span class="kw">return</span>(out)</span>
<span id="cb96-14"><a href="#cb96-14"></a>}</span>
<span id="cb96-15"><a href="#cb96-15"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m){</span>
<span id="cb96-16"><a href="#cb96-16"></a>  xt &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb96-17"><a href="#cb96-17"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dt">mean=</span>xt) <span class="co">## At each transition, the candidate point Y is generated from N(mean=xt)</span></span>
<span id="cb96-18"><a href="#cb96-18"></a>  R &lt;-<span class="st"> </span><span class="kw">f</span>(y)<span class="op">*</span><span class="kw">dnorm</span>(xt,<span class="dt">mean=</span>y)<span class="op">/</span>(<span class="kw">f</span>(xt)<span class="op">*</span><span class="kw">dnorm</span>(y,<span class="dt">mean=</span>xt)) <span class="co">## accept probability</span></span>
<span id="cb96-19"><a href="#cb96-19"></a>  <span class="cf">if</span>(u[i] <span class="op">&lt;=</span><span class="st"> </span>R){</span>
<span id="cb96-20"><a href="#cb96-20"></a>    x[i] &lt;-<span class="st"> </span>y</span>
<span id="cb96-21"><a href="#cb96-21"></a>  }<span class="cf">else</span>{</span>
<span id="cb96-22"><a href="#cb96-22"></a>    x[i] &lt;-<span class="st"> </span>xt</span>
<span id="cb96-23"><a href="#cb96-23"></a>    k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span> <span class="co">## y is rejected</span></span>
<span id="cb96-24"><a href="#cb96-24"></a>  }</span>
<span id="cb96-25"><a href="#cb96-25"></a>}</span>
<span id="cb96-26"><a href="#cb96-26"></a><span class="kw">print</span>(k<span class="op">/</span>m)</span></code></pre></div>
<pre><code>## [1] 0.2393333</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>I &lt;-<span class="st"> </span><span class="dv">1001</span><span class="op">:</span>m <span class="co">##  The following code will display a partial plot starting at time index 1000.</span></span>
<span id="cb98-2"><a href="#cb98-2"></a><span class="kw">plot</span>(I,x[I],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="kw">hist</span>(x[I], <span class="dt">probability=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="dv">100</span>)</span>
<span id="cb99-2"><a href="#cb99-2"></a>plot.x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(x[I]),<span class="kw">max</span>(x[I]),<span class="fl">0.01</span>)</span>
<span id="cb99-3"><a href="#cb99-3"></a><span class="kw">lines</span>(plot.x,<span class="kw">f</span>(plot.x))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="co">#compare the deciles</span></span>
<span id="cb100-2"><a href="#cb100-2"></a>observations &lt;-<span class="st"> </span><span class="kw">quantile</span>(x[I],<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))</span>
<span id="cb100-3"><a href="#cb100-3"></a>expectations &lt;-<span class="st"> </span><span class="kw">qcauchy</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))</span>
<span id="cb100-4"><a href="#cb100-4"></a>decile &lt;-<span class="st"> </span><span class="kw">data.frame</span>(observations,expectations)</span>
<span id="cb100-5"><a href="#cb100-5"></a>decile</span></code></pre></div>
<pre><code>##      observations expectations
## 0%   -12.82838117         -Inf
## 10%   -2.51435985   -3.0776835
## 20%   -1.27498926   -1.3763819
## 30%   -0.70147787   -0.7265425
## 40%   -0.28498167   -0.3249197
## 50%    0.04917375    0.0000000
## 60%    0.41065271    0.3249197
## 70%    0.81089226    0.7265425
## 80%    1.46463134    1.3763819
## 90%    2.83091396    3.0776835
## 100%  14.04428978          Inf</code></pre>
<p><br />
In this question, approximately 24% of the candidate points are rejected, so the chain is somewhat efficient.<br />
We can see, the deciles of the generated observations and the deciles of the standard Cauchy distribution is very close.<br />
The following QQ and histograms can also verify this conclusion.<br />
</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="kw">qqnorm</span>(x[I])</span>
<span id="cb102-2"><a href="#cb102-2"></a><span class="kw">qqline</span>(x[I])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a>sequence &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb103-2"><a href="#cb103-2"></a>standard.Cauchy &lt;-<span class="st"> </span><span class="kw">qcauchy</span>(sequence)</span>
<span id="cb103-3"><a href="#cb103-3"></a>standard.Cauchy &lt;-<span class="st"> </span>standard.Cauchy[(standard.Cauchy<span class="op">&gt;</span><span class="st"> </span><span class="op">-</span><span class="ot">Inf</span>) </span>
<span id="cb103-4"><a href="#cb103-4"></a>                                 <span class="op">&amp;</span><span class="st"> </span>(standard.Cauchy<span class="op">&lt;</span><span class="st"> </span><span class="ot">Inf</span>)]</span>
<span id="cb103-5"><a href="#cb103-5"></a><span class="kw">hist</span>(x[I], <span class="dt">freq =</span> <span class="ot">FALSE</span>)</span>
<span id="cb103-6"><a href="#cb103-6"></a><span class="kw">lines</span>(standard.Cauchy, <span class="kw">dcauchy</span>(standard.Cauchy), <span class="dt">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-9.8" class="section level2">
<h2>Question 9.8</h2>
<p>This example appears in [40]. Consider the bivariate density<br />
<span class="math display">\[
f(x,y)\propto \binom{n}{x}y^{x+a-1}(1-y)^{n-x+b-1},x=0,1,\cdots,n,0\leq y\leq 1.
\]</span><br />
It can be shown (see e.g. [23]) that for fixed a, b, n, the conditional distributions are Binomial(n, y) and Beta(x + a, n − x + b). Use the Gibbs sampler to generate a chain with target joint density f(x, y).<br />
</p>
<p><strong>Solution:</strong></p>
<p>The bivariate density in this question follows that (supressing the overall dependence on n , a , b) that<br />
<span class="math display">\[
f(x|y)\sim Binomial(n,y)\\
f(y|x)\sim Beta(x+a,n-x+b)
\]</span><br />
The Gibbs sampler proceeds as follows:<br />
(1) Start from some value of (X(0); Y (0))<br />
(2) Generate X(i) from Binomial(n, Y (i-1))<br />
(3) Generate Y (i) from Beta(X(i) + a , n − X(i) + b )<br />
</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="kw">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb104-2"><a href="#cb104-2"></a>f =<span class="st"> </span><span class="cf">function</span>(x,y){</span>
<span id="cb104-3"><a href="#cb104-3"></a><span class="kw">choose</span>(n,x) <span class="op">*</span><span class="st"> </span>y<span class="op">^</span>(x <span class="op">+</span><span class="st"> </span>a <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>y)<span class="op">^</span>(n <span class="op">-</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>b <span class="dv">-1</span>)</span>
<span id="cb104-4"><a href="#cb104-4"></a>} <span class="co">## x = 0,1,2,...,n and 0 &lt; y &lt; 1</span></span>
<span id="cb104-5"><a href="#cb104-5"></a>N &lt;-<span class="st"> </span><span class="dv">10000</span>   <span class="co">## sample size</span></span>
<span id="cb104-6"><a href="#cb104-6"></a><span class="co">## fixed a,b and n</span></span>
<span id="cb104-7"><a href="#cb104-7"></a>a &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb104-8"><a href="#cb104-8"></a>b &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb104-9"><a href="#cb104-9"></a>n &lt;-<span class="st"> </span><span class="dv">16</span></span>
<span id="cb104-10"><a href="#cb104-10"></a>X=<span class="ot">NULL</span> <span class="co">## Vector of X values</span></span>
<span id="cb104-11"><a href="#cb104-11"></a>X[<span class="dv">1</span>]=<span class="dv">5</span> <span class="co">## initial value of X given to be 5</span></span>
<span id="cb104-12"><a href="#cb104-12"></a>Y=<span class="ot">NULL</span> <span class="co">## Vector of Y values</span></span>
<span id="cb104-13"><a href="#cb104-13"></a>Y[<span class="dv">1</span>]=<span class="fl">0.33</span> <span class="co">## initial value of Y given to be 0.33</span></span>
<span id="cb104-14"><a href="#cb104-14"></a>Z=<span class="kw">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>) <span class="co">## the chain,a bivariate sample</span></span>
<span id="cb104-15"><a href="#cb104-15"></a><span class="co">## generate the chain</span></span>
<span id="cb104-16"><a href="#cb104-16"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb104-17"><a href="#cb104-17"></a>   X[i]=<span class="kw">rbinom</span>(<span class="dv">1</span>,n,Y[i<span class="dv">-1</span>])</span>
<span id="cb104-18"><a href="#cb104-18"></a>   Y[i]=<span class="kw">rbeta</span>(<span class="dv">1</span>,(X[i]<span class="op">+</span>a),(n<span class="op">-</span>X[i]<span class="op">+</span>b))</span>
<span id="cb104-19"><a href="#cb104-19"></a>   Z[i,]=<span class="kw">c</span>(X[i],Y[i])</span>
<span id="cb104-20"><a href="#cb104-20"></a>}</span>
<span id="cb104-21"><a href="#cb104-21"></a>sample_X &lt;-<span class="st"> </span>Z[(<span class="dv">1</span><span class="op">:</span>N),<span class="dv">1</span>]<span class="co">## The first column of Z gives X values of the sample</span></span>
<span id="cb104-22"><a href="#cb104-22"></a>sample_Y &lt;-<span class="st"> </span>Z[(<span class="dv">1</span><span class="op">:</span>N),<span class="dv">2</span>]<span class="co">## The second column of Z gives Y values of the sample</span></span>
<span id="cb104-23"><a href="#cb104-23"></a></span>
<span id="cb104-24"><a href="#cb104-24"></a>sample&lt;-<span class="kw">round</span>(<span class="kw">c</span>(<span class="kw">mean</span>(sample_X),<span class="kw">mean</span>(sample_Y)),<span class="dv">4</span>) <span class="co">#Estimated mean of marginal random variable X from sample</span></span>
<span id="cb104-25"><a href="#cb104-25"></a>true&lt;-<span class="kw">round</span>(<span class="kw">c</span>(n<span class="op">*</span>Y[<span class="dv">1</span>],(X[<span class="dv">1</span>]<span class="op">+</span>a)<span class="op">/</span>(X[<span class="dv">1</span>]<span class="op">+</span>a<span class="op">+</span>n<span class="op">-</span>X[<span class="dv">1</span>]<span class="op">+</span>b)),<span class="dv">4</span>)</span>
<span id="cb104-26"><a href="#cb104-26"></a>compare &lt;-<span class="st"> </span><span class="kw">data.frame</span>(sample,true)</span>
<span id="cb104-27"><a href="#cb104-27"></a>compare</span></code></pre></div>
<pre><code>##   sample   true
## 1 5.2660 5.2800
## 2 0.3304 0.3182</code></pre>
<p><br />
Conclusion:The sample means are very close to the true mean,so we use the Gibbs sampler to generate a chain with target joint density f(x, y).<br />
</p>
</div>
<div id="continuequestion-9.3" class="section level2">
<h2>(Continue)Question 9.3</h2>
<p>For Question 9.3, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.<br />
</p>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="co"># Gelman-Rubin statistic</span></span>
<span id="cb106-2"><a href="#cb106-2"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb106-3"><a href="#cb106-3"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb106-4"><a href="#cb106-4"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb106-5"><a href="#cb106-5"></a>  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb106-6"><a href="#cb106-6"></a>  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb106-7"><a href="#cb106-7"></a>  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb106-8"><a href="#cb106-8"></a></span>
<span id="cb106-9"><a href="#cb106-9"></a>  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb106-10"><a href="#cb106-10"></a>  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb106-11"><a href="#cb106-11"></a>  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb106-12"><a href="#cb106-12"></a>  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb106-13"><a href="#cb106-13"></a>  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb106-14"><a href="#cb106-14"></a>  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W             <span class="co">#G-R statistic</span></span>
<span id="cb106-15"><a href="#cb106-15"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb106-16"><a href="#cb106-16"></a>}</span>
<span id="cb106-17"><a href="#cb106-17"></a></span>
<span id="cb106-18"><a href="#cb106-18"></a><span class="co">## generates a Metropolis chain for Cauchy(0,1)</span></span>
<span id="cb106-19"><a href="#cb106-19"></a><span class="co">## with Normal(mean=xt) proposal distribution</span></span>
<span id="cb106-20"><a href="#cb106-20"></a><span class="co">## and starting value X1</span></span>
<span id="cb106-21"><a href="#cb106-21"></a>Standard_Cauchy_Chain &lt;-<span class="st"> </span><span class="cf">function</span>(N, X1){</span>
<span id="cb106-22"><a href="#cb106-22"></a>  X &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb106-23"><a href="#cb106-23"></a>  X[<span class="dv">1</span>] &lt;-<span class="st"> </span>X1    <span class="co">#初始值</span></span>
<span id="cb106-24"><a href="#cb106-24"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb106-25"><a href="#cb106-25"></a>    Xt &lt;-<span class="st"> </span>X[i<span class="dv">-1</span>]</span>
<span id="cb106-26"><a href="#cb106-26"></a>    Y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="kw">abs</span>(Xt))</span>
<span id="cb106-27"><a href="#cb106-27"></a>    r &lt;-<span class="st"> </span><span class="kw">dt</span>(Y,<span class="dv">1</span>)<span class="op">*</span><span class="kw">dnorm</span>(Xt,<span class="dv">0</span>,<span class="kw">abs</span>(Y))<span class="op">/</span><span class="kw">dt</span>(Xt,<span class="dv">1</span>)<span class="op">/</span><span class="kw">dnorm</span>(Y,<span class="dv">0</span>,<span class="kw">abs</span>(Xt))</span>
<span id="cb106-28"><a href="#cb106-28"></a>    U &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</span>
<span id="cb106-29"><a href="#cb106-29"></a>    <span class="cf">if</span>(r <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) r &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb106-30"><a href="#cb106-30"></a>    <span class="cf">if</span>(U <span class="op">&lt;=</span><span class="st"> </span>r) X[i] &lt;-<span class="st"> </span>Y</span>
<span id="cb106-31"><a href="#cb106-31"></a>    <span class="cf">else</span> X[i] &lt;-<span class="st"> </span>Xt</span>
<span id="cb106-32"><a href="#cb106-32"></a>  }</span>
<span id="cb106-33"><a href="#cb106-33"></a>  <span class="kw">return</span>(X)</span>
<span id="cb106-34"><a href="#cb106-34"></a>}</span>
<span id="cb106-35"><a href="#cb106-35"></a>k &lt;-<span class="st"> </span><span class="dv">4</span>      </span>
<span id="cb106-36"><a href="#cb106-36"></a>N &lt;-<span class="st"> </span><span class="dv">8000</span></span>
<span id="cb106-37"><a href="#cb106-37"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span>     <span class="co">#burn-in length</span></span>
<span id="cb106-38"><a href="#cb106-38"></a>X1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>)    <span class="co">#initial value</span></span>
<span id="cb106-39"><a href="#cb106-39"></a></span>
<span id="cb106-40"><a href="#cb106-40"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb106-41"><a href="#cb106-41"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> k, <span class="dt">ncol =</span> N)</span>
<span id="cb106-42"><a href="#cb106-42"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb106-43"><a href="#cb106-43"></a>  X[i,] &lt;-<span class="st"> </span><span class="kw">Standard_Cauchy_Chain</span>(N, X1[i])</span>
<span id="cb106-44"><a href="#cb106-44"></a>}</span>
<span id="cb106-45"><a href="#cb106-45"></a></span>
<span id="cb106-46"><a href="#cb106-46"></a><span class="co"># compute diagnostic statistics</span></span>
<span id="cb106-47"><a href="#cb106-47"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb106-48"><a href="#cb106-48"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb106-49"><a href="#cb106-49"></a>  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb106-50"><a href="#cb106-50"></a><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.127139</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb108-2"><a href="#cb108-2"></a>  <span class="cf">if</span>(i<span class="op">==</span><span class="dv">1</span>){</span>
<span id="cb108-3"><a href="#cb108-3"></a>    <span class="kw">plot</span>((b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N,psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N],<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb108-4"><a href="#cb108-4"></a>         <span class="dt">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="dt">ylab=</span><span class="kw">bquote</span>(phi))</span>
<span id="cb108-5"><a href="#cb108-5"></a>  }<span class="cf">else</span>{</span>
<span id="cb108-6"><a href="#cb108-6"></a>      <span class="kw">lines</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">col=</span>i)</span>
<span id="cb108-7"><a href="#cb108-7"></a>  }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb109-2"><a href="#cb109-2"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb109-3"><a href="#cb109-3"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb109-4"><a href="#cb109-4"></a>  rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb109-5"><a href="#cb109-5"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb109-6"><a href="#cb109-6"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
From the results, we can see that the <span class="math inline">\(\hat{R}\)</span> is <span class="math inline">\(1.127139&lt;1.2\)</span>. It shows that the chains have approximately converged to the target distribution when sample size approximately equal 1000.</p>
</div>
<div id="continuequestion-9.8" class="section level2">
<h2>(Continue)Question 9.8</h2>
<p>For Question 9.8, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.<br />
</p>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="co"># Gelman-Rubin statistic</span></span>
<span id="cb110-2"><a href="#cb110-2"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb110-3"><a href="#cb110-3"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb110-4"><a href="#cb110-4"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb110-5"><a href="#cb110-5"></a>  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb110-6"><a href="#cb110-6"></a>  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb110-7"><a href="#cb110-7"></a>  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb110-8"><a href="#cb110-8"></a></span>
<span id="cb110-9"><a href="#cb110-9"></a>  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb110-10"><a href="#cb110-10"></a>  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb110-11"><a href="#cb110-11"></a>  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb110-12"><a href="#cb110-12"></a>  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb110-13"><a href="#cb110-13"></a>  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb110-14"><a href="#cb110-14"></a>  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W             <span class="co">#G-R statistic</span></span>
<span id="cb110-15"><a href="#cb110-15"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb110-16"><a href="#cb110-16"></a>}</span>
<span id="cb110-17"><a href="#cb110-17"></a>Bivariate.Gibbs &lt;-<span class="st"> </span><span class="cf">function</span>(N, X1){</span>
<span id="cb110-18"><a href="#cb110-18"></a>  a &lt;-<span class="st"> </span>b &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb110-19"><a href="#cb110-19"></a>  X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb110-20"><a href="#cb110-20"></a>  X[<span class="dv">1</span>,] &lt;-<span class="st"> </span>X1    <span class="co">#初始值</span></span>
<span id="cb110-21"><a href="#cb110-21"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb110-22"><a href="#cb110-22"></a>    X2 &lt;-<span class="st">  </span>X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb110-23"><a href="#cb110-23"></a>    X[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>,<span class="dv">25</span>,X2)</span>
<span id="cb110-24"><a href="#cb110-24"></a>    X1 &lt;-<span class="st"> </span>X[i,<span class="dv">1</span>]</span>
<span id="cb110-25"><a href="#cb110-25"></a>    X[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>,X1<span class="op">+</span>a,<span class="dv">25</span><span class="op">-</span>X1<span class="op">+</span>b)</span>
<span id="cb110-26"><a href="#cb110-26"></a>  }</span>
<span id="cb110-27"><a href="#cb110-27"></a>  <span class="kw">return</span>(X)</span>
<span id="cb110-28"><a href="#cb110-28"></a>}</span>
<span id="cb110-29"><a href="#cb110-29"></a>k &lt;-<span class="st"> </span><span class="dv">4</span>          </span>
<span id="cb110-30"><a href="#cb110-30"></a>N &lt;-<span class="st"> </span><span class="dv">8000</span> </span>
<span id="cb110-31"><a href="#cb110-31"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span>    <span class="co">#burn-in length</span></span>
<span id="cb110-32"><a href="#cb110-32"></a>X1 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">10</span>,<span class="dv">15</span>),<span class="kw">runif</span>(<span class="dv">4</span>)) <span class="co"># initial value</span></span>
<span id="cb110-33"><a href="#cb110-33"></a></span>
<span id="cb110-34"><a href="#cb110-34"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb110-35"><a href="#cb110-35"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>N)</span>
<span id="cb110-36"><a href="#cb110-36"></a>Y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>N)</span>
<span id="cb110-37"><a href="#cb110-37"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb110-38"><a href="#cb110-38"></a>  BG &lt;-<span class="st"> </span><span class="kw">Bivariate.Gibbs</span>(N, X1[i,])</span>
<span id="cb110-39"><a href="#cb110-39"></a>  X[i, ] &lt;-<span class="st"> </span>BG[,<span class="dv">1</span>]</span>
<span id="cb110-40"><a href="#cb110-40"></a>  Y[i, ] &lt;-<span class="st"> </span>BG[,<span class="dv">2</span>]</span>
<span id="cb110-41"><a href="#cb110-41"></a>}</span>
<span id="cb110-42"><a href="#cb110-42"></a><span class="co"># Consider X</span></span>
<span id="cb110-43"><a href="#cb110-43"></a></span>
<span id="cb110-44"><a href="#cb110-44"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb110-45"><a href="#cb110-45"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb110-46"><a href="#cb110-46"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb110-47"><a href="#cb110-47"></a>  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb110-48"><a href="#cb110-48"></a></span>
<span id="cb110-49"><a href="#cb110-49"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb110-50"><a href="#cb110-50"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb110-51"><a href="#cb110-51"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb110-52"><a href="#cb110-52"></a>  rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb110-53"><a href="#cb110-53"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb110-54"><a href="#cb110-54"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="co"># Consider Y</span></span>
<span id="cb111-2"><a href="#cb111-2"></a></span>
<span id="cb111-3"><a href="#cb111-3"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb111-4"><a href="#cb111-4"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(Y, <span class="dv">1</span>, cumsum))</span>
<span id="cb111-5"><a href="#cb111-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb111-6"><a href="#cb111-6"></a>  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb111-7"><a href="#cb111-7"></a></span>
<span id="cb111-8"><a href="#cb111-8"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb111-9"><a href="#cb111-9"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb111-10"><a href="#cb111-10"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb111-11"><a href="#cb111-11"></a>  rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb111-12"><a href="#cb111-12"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb111-13"><a href="#cb111-13"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
From the results, we can see the chains have approximately converged to the target joint density f(x, y) when sample size approximately equal 4000.<br />
</p>
</div>
<div id="title-a-21010-2021-11-18" class="section level2">
<h2>title: “A-21010-2021-11-18”</h2>
</div>
<div id="exercise-11.3-and-11.5pages-353-354statistical-computing-with-r" class="section level2">
<h2>Exercise 11.3 and 11.5(pages 353-354,Statistical Computing with R)</h2>
</div>
<div id="e-m-algorithm" class="section level2">
<h2>E-M algorithm</h2>
<p>Suppose <span class="math inline">\(T_1,\cdots,T_n\)</span> are i.i.d samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>.Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to the right censorship, so that the observed values are <span class="math inline">\(Y_i=T_iI(T_i\leq\tau)+\tau I(T_i&gt;\tau),i=1,\cdots,n\)</span>.Suppose <span class="math inline">\(\tau=1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[
0.54,0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85
\]</span><br />
Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>,compare your result with the observed data MLE(note:Y_i follows a mixture distribution).</p>
</div>
<div id="question-11.3" class="section level2">
<h2>Question 11.3</h2>
<ol style="list-style-type: lower-alpha">
<li>Write a function to compute the <span class="math inline">\(k^{th}\)</span> term in<br />
<span class="math display">\[
\sum_{k=0}^\infty\frac{(-1)^k}{k!2^k}\frac{||a||^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma(\frac{d+1}{2})\Gamma(k+\frac{3}{2})}{\Gamma(k+\frac{d}{2}+1)}
\]</span><br />
where <span class="math inline">\(d ≥ 1\)</span> is an integer, <span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(R^d\)</span>, and <span class="math inline">\(||\cdot||\)</span> denotes the Euclidean norm. Perform the arithmetic so that the coefficients can be computed for (almost) arbitrarily large k and d. (This sum converges for all <span class="math inline">\(a\in R^d\)</span>).<br />
</li>
<li>Modify the function so that it computes and returns the sum.<br />
</li>
<li>Evaluate the sum when <span class="math inline">\(a = (1, 2)^T\)</span>.<br />
</li>
</ol>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="co">## (a)Write a function to compute the k^{th} term</span></span>
<span id="cb112-2"><a href="#cb112-2"></a>f=<span class="cf">function</span>(a,k){</span>
<span id="cb112-3"><a href="#cb112-3"></a>d=<span class="kw">length</span>(a)</span>
<span id="cb112-4"><a href="#cb112-4"></a>((<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span>k<span class="op">/</span>(<span class="kw">factorial</span>(k)<span class="op">*</span><span class="dv">2</span><span class="op">^</span>k))<span class="op">*</span>(<span class="kw">sqrt</span>(<span class="kw">sum</span>(a<span class="op">*</span>a))<span class="op">^</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span>((<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>)))<span class="op">*</span>((<span class="kw">gamma</span>((d<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">gamma</span>(k<span class="fl">+1.5</span>))<span class="op">/</span><span class="kw">gamma</span>(k<span class="op">+</span>d<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb112-5"><a href="#cb112-5"></a>}</span>
<span id="cb112-6"><a href="#cb112-6"></a><span class="co">## (b)Modify the function so that it computes and returns the sum</span></span>
<span id="cb112-7"><a href="#cb112-7"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>) <span class="co">## value of a</span></span>
<span id="cb112-8"><a href="#cb112-8"></a>p &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb112-9"><a href="#cb112-9"></a>q &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb112-10"><a href="#cb112-10"></a>k &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb112-11"><a href="#cb112-11"></a><span class="cf">while</span>(<span class="kw">is.nan</span>(p)<span class="op">==</span><span class="ot">FALSE</span>){ </span>
<span id="cb112-12"><a href="#cb112-12"></a><span class="co">## we stop calculaton when r starts providing NaN for k^{th} term calculation</span></span>
<span id="cb112-13"><a href="#cb112-13"></a>q[k]=<span class="kw">f</span>(a,k<span class="dv">-1</span>) <span class="co">## the k^{th} term of series</span></span>
<span id="cb112-14"><a href="#cb112-14"></a>p=q[k]</span>
<span id="cb112-15"><a href="#cb112-15"></a>k=k<span class="op">+</span><span class="dv">1</span> <span class="co">## increase the k by 1</span></span>
<span id="cb112-16"><a href="#cb112-16"></a>}</span>
<span id="cb112-17"><a href="#cb112-17"></a><span class="co">## (c)Evaluate the sum when $a = (1, 2)^T$</span></span>
<span id="cb112-18"><a href="#cb112-18"></a><span class="kw">sum</span>(q[<span class="op">-</span><span class="kw">length</span>(q)])</span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
<p><br />
</p>
</div>
<div id="question-11.5" class="section level2">
<h2>Question 11.5</h2>
<p>Write a function to solve the equation<br />
<span class="math display">\[
\begin{gathered}
\frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u =\frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u
\end{gathered}
\]</span><br />
for <span class="math inline">\(a\)</span>,where<br />
<span class="math display">\[
c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}}
\]</span><br />
Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in the Exercise 11.4.<br />
</p>
<p><strong>Solution:</strong></p>
<p>For Exercise 11.4<br />
</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a><span class="co"># find the intervals in which the roots fall  </span></span>
<span id="cb114-2"><a href="#cb114-2"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(a, k) <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)), k)</span>
<span id="cb114-3"><a href="#cb114-3"></a>k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</span>
<span id="cb114-4"><a href="#cb114-4"></a><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb114-5"><a href="#cb114-5"></a><span class="cf">for</span> (i <span class="cf">in</span> k) {</span>
<span id="cb114-6"><a href="#cb114-6"></a>  g &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">f</span>(x, i<span class="dv">-1</span>)<span class="op">-</span><span class="kw">f</span>(x, i)</span>
<span id="cb114-7"><a href="#cb114-7"></a>    a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="kw">sqrt</span>(i), <span class="fl">.1</span>)</span>
<span id="cb114-8"><a href="#cb114-8"></a>  <span class="kw">plot</span>(a, <span class="kw">g</span>(a), <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&#39;k=&#39;</span>,i))</span>
<span id="cb114-9"><a href="#cb114-9"></a>  <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</span>
<span id="cb114-10"><a href="#cb114-10"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ZrY6kNtmAABmOgBmZgBmkLZmtttmtv+QOgCQttuQ2/+2ZgC2Zjq2kDq229u22/+2/9u2///bkDrbkGbbtpDb////tmb/25D//7b//9v///+4bi1TAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEc0lEQVR4nO3c2VrTQABA4QEBV0TFBRC1ff+XNLQUWtrMCdlm6TkXkm8WSH7bmlxIWFq0kPoEck8gSCAoAdC3cHoTnT67f/i6uA7h5NPLw9nLDejBYgW0uAoPne8ezl9mQL8/hEeg23DyZXkXwuedw/lLBfTvfTj9+fcirDv5up66bQ4vVkDNq+b88c+twwQlAmout0E5APTmx9UKqAF8t1x/IG0dzn+yiYB+Xa3eMHtAd2/vF2ugZmqtcnqzdTj/ySYC+hhW13wogZor3XrN7CXQGmijsPsWWwq0XAGdfT/8GbR8AjryD+mb5qKby40Arb9s/pnfHCYo1X3Qn7b7vkegh7vDy+cbxcuju1HcOOy1mTj6R43Hj969nuQW1xfPD6sXx/SwWlaHgMLR1hVo5L+EYhIIEggSCBIIEggSCBIIGgx0+FaqnoYDVf7iGgoUInNVJBA0BlDVQgJBA4FCdLaGBIIEggSChgGF6GwVjQNUsZBAkEDQIKAQn64igSCBIIGgkYDqFRoCFGC+igSCBIIEggSCBIIEgsYCqlZoAFCgBVUkECQQJBAkECQQJBAkEDQaUK1CAkECQf2BXo4IBCMCwYhAMCIQjAhEI3UKCQQJBAkECQQJBMUxYr+AQKD4GD+91pFAkECQQJBAkECQQNCYQFUKCQQJBAkECQQJBAkE9QU6aCFQfI1AsEYgWFOlkECQQJBAkECQQJBAkECQQJBAkECQQNC4QBUK9QRqgxAosiQ2Xm4CQQJBAkECQQJBAkECQQJBAkEjA9UnJBAkECQQJBDUD6idQaDWFTRTaAJBAkECQQJBAkFjA1UnJBAkECQQJBAkECQQJBDUCyiGIFDLgi5zJSYQFMdo+QVLUYTKhEZ/BQnUsqDbZHkJBAkECQQJBAkEjQ9UmVAfIBAQSCAYEwjGBIIxgWBMIBgTCMZIoCohgSCBIIEggaAeQHj9AvX4nsUmECQQNAVQVUICQQJBAkECQQJBAkECQQJBAkECQZMA1ST0eqAuFy9Qj+9aaAJBAkECQQJBAkECQQJBAkHTAFUkJBAkECQQJBAkECQQJBAkECQQ9GqgjpdejZBAkECQQJBAkECQQJBA0FRA1QjBXbO9/lFjgDxtaTmfpOUDlJ/NqlyAMuXJBShbngmBXrMjX548gHL2yQEoa58MgPL2SQ+UuU9yoNx9JgTqtCV7n8RA+fukBSrAJylQCT4CUQmBivCZEoj2CBTfU4aPQFQyoEJ8BKJSAZXikwqoGJ9JgSKbBIpvKsdHICoJUEE+AlEpgErymRaoZZdAsEug+K6ifASi5gcqy0cgalqgA9sK8xGImhuoNB+BqImBXu4rzmdmoPJ8BKJmBSrQZ3KgnY0CxTeW6DM90NZOgeI/oUifGYCetgoU/RkZ/3+VaHMANZtL5ZkJqNB316p5gApOIEggSCBIIEggSCBIIKgz0NHWEajb5Kyr052KQAINWy2QQMNWCyTQsNUCCTRstUCjGhxhAkECQQJBAkECQQJBAkECQf8BzFG0S3FR8q0AAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ZrY6kNtmAABmOgBmZgBmkLZmtttmtv+QOgCQttuQ2/+2ZgC2Zjq2kDq229u22/+2/9u2///bkDrbkGbbtpDb////tmb/25D//7b//9v///+4bi1TAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAD3ElEQVR4nO3cbXfSMABA4YAbvos6X9icSv//n7S0wKakvdDmRJre+2HkpDk95BnrCh8IlfUW/vcTuPYEggSCsgJ9DstN7+Gbx93j9i6ExbueYc6uB2gH0ABt12HXbecwa1cD9ONN2APdh8XH6iGED13DrOUH+v06LL/9WoW2xaf20H09XDVA9Uvldv8zPsxbdqB6jzVKBOjF13UDVAO+qtoLUnyY8xnnB/q+bv5KToAeXj5uW6D6UEux3MSHOZ9xfqC3odloLIHq7T17zZwkUAt0UPj7T6wSqGqAbr7Er0HVEWjmF+lNvdN6jz1A7cPhf3tkmLf890E/u2729kC7W8L3T3eHkWHW8gMdHE46HJj9W4399fako9z2bvX0DjU2zJkfd0AxoDDbzgVK/EuYTAJBAkECQQJBAkECQQJBw4Cit09lJhAkECQQNAgozOiaPRBoPkICQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQUOBZiM0BCh0LSoxgSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggaB+jPgXEAgEcwLBXOhcVWACQQJBAkECQQJBA4BC96oCEwgSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIuhwo9KwqMIEggSCBIIEggSCBIIEggSCBoOFAMxESCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCAKMyDdQCeQr6HkCQQJBAkECQQJBI4DmISQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQNAZoFkICQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQRcDBVhYWgJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQfD5s13+oX3/ZOdJp1pioKJsmpIClcczEujf2QJ9BKJSApXokxKoSB+BKIEggaB0QGX6CEQJBCUDKtRHIEogKBVQqT4CUQJB44Din+UXlUCQQJBAkEBQIqBifQSiBIIEgtIAlesjECUQNBJoPy+QQEPmjvMF+whECQQJBAkECQQJBAkEpQAq2UcgSiBIICgBUNE+o4HqAwJ1ze0PCNQ11x4o22c8UOEvoARAhScQJBAkECQQJBAkECQQdDbQbDsT6LyDlyya6Ilw4UT3JVCuE+HCie5LoFwnwoUT3ZdAuU6ECye6L4FynQgXTnRf+YBMIEwgSCBIIEggSCBIIEgg6A/mTKnrX1C1qQAAAABJRU5ErkJggg==" /><!-- --><br />
From the figures plotted when k = 4, 25, 100 and 1000, we can conclude that the roots will fall in the interval (1, 2).<br />
</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(a, k) <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)), k)</span>
<span id="cb115-2"><a href="#cb115-2"></a>k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb115-3"><a href="#cb115-3"></a>Ak &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(k))</span>
<span id="cb115-4"><a href="#cb115-4"></a>i &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb115-5"><a href="#cb115-5"></a><span class="cf">for</span> (j <span class="cf">in</span> k) {</span>
<span id="cb115-6"><a href="#cb115-6"></a>  g &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">f</span>(x, j<span class="dv">-1</span>)<span class="op">-</span><span class="kw">f</span>(x, j)</span>
<span id="cb115-7"><a href="#cb115-7"></a>  Ak[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(g, <span class="dt">lower =</span> <span class="dv">1</span>, <span class="dt">upper =</span> <span class="dv">2</span>)<span class="op">$</span>root</span>
<span id="cb115-8"><a href="#cb115-8"></a>  i &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb115-9"><a href="#cb115-9"></a>}</span>
<span id="cb115-10"><a href="#cb115-10"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(k,Ak))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">Ak</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">1.492103</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1.533556</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1.562744</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1.584430</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">1.601185</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">1.614521</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">1.625390</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">1.634419</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">1.642038</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">1.648554</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">1.654190</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">1.659114</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">1.663452</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">1.667304</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">1.670745</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">1.673840</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">1.676637</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">1.679178</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="right">1.681496</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">1.683620</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">1.685572</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">1.687373</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.720608</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">1.729756</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">1.730908</td>
</tr>
</tbody>
</table>
<p><br />
For this Question 11.5<br />
</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(k) <span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb116-2"><a href="#cb116-2"></a>ck &lt;-<span class="st"> </span><span class="cf">function</span>(a, k) <span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb116-3"><a href="#cb116-3"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(u, k) (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb116-4"><a href="#cb116-4"></a>k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb116-5"><a href="#cb116-5"></a>root &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(k))</span>
<span id="cb116-6"><a href="#cb116-6"></a>i &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb116-7"><a href="#cb116-7"></a><span class="cf">for</span> (j <span class="cf">in</span> k) {</span>
<span id="cb116-8"><a href="#cb116-8"></a>  ff &lt;-<span class="st"> </span><span class="cf">function</span>(a) <span class="kw">f</span>(j)<span class="op">*</span><span class="kw">integrate</span>(<span class="cf">function</span>(u) {<span class="kw">g</span>(u, j)}, <span class="dv">0</span>, <span class="kw">ck</span>(a, j))<span class="op">$</span>value<span class="op">-</span><span class="kw">f</span>(j<span class="dv">-1</span>)<span class="op">*</span><span class="kw">integrate</span>(<span class="cf">function</span>(u) {<span class="kw">g</span>(u, j<span class="dv">-1</span>)}, <span class="dv">0</span>, <span class="kw">ck</span>(a, j<span class="dv">-1</span>))<span class="op">$</span>value </span>
<span id="cb116-9"><a href="#cb116-9"></a>  root[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(ff, <span class="dt">lower =</span> <span class="dv">1</span>, <span class="dt">upper =</span> <span class="dv">2</span>)<span class="op">$</span>root</span>
<span id="cb116-10"><a href="#cb116-10"></a>  i &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb116-11"><a href="#cb116-11"></a>}</span>
<span id="cb116-12"><a href="#cb116-12"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(k, Ak, root))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">Ak</th>
<th align="right">root</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">1.492103</td>
<td align="right">1.492103</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1.533556</td>
<td align="right">1.533556</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1.562744</td>
<td align="right">1.562744</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1.584430</td>
<td align="right">1.584430</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">1.601185</td>
<td align="right">1.601185</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">1.614521</td>
<td align="right">1.614521</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">1.625390</td>
<td align="right">1.625390</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">1.634419</td>
<td align="right">1.634419</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">1.642038</td>
<td align="right">1.642038</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">1.648554</td>
<td align="right">1.648554</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">1.654190</td>
<td align="right">1.654190</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">1.659114</td>
<td align="right">1.659114</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">1.663452</td>
<td align="right">1.663452</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">1.667304</td>
<td align="right">1.667304</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">1.670745</td>
<td align="right">1.670745</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">1.673840</td>
<td align="right">1.673840</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">1.676637</td>
<td align="right">1.676637</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">1.679178</td>
<td align="right">1.679178</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="right">1.681496</td>
<td align="right">1.681496</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">1.683620</td>
<td align="right">1.683620</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">1.685572</td>
<td align="right">1.685572</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">1.687373</td>
<td align="right">1.687373</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.720608</td>
<td align="right">1.720608</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">1.729756</td>
<td align="right">1.729756</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">1.730908</td>
<td align="right">1.730907</td>
</tr>
</tbody>
</table>
<p><br />
Conclusion:In the above table, the outcomes in ‘Ak’ column are the outcomes in Exercise 11.4 and these in ‘root’ column are the outcomes in this Question 11.5. We can see that the results are the same. This result is obvious as these two questions are in fact the same.<br />
</p>
</div>
<div id="e-m-algorithm-1" class="section level2">
<h2>E-M algorithm</h2>
<p>Suppose <span class="math inline">\(T_1,\cdots,T_n\)</span> are i.i.d samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>.Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to the right censorship, so that the observed values are <span class="math inline">\(Y_i=T_iI(T_i\leq\tau)+\tau I(T_i&gt;\tau),i=1,\cdots,n\)</span>.Suppose <span class="math inline">\(\tau=1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[
0.54,0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85
\]</span><br />
Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>,compare your result with the observed data MLE(note:Y_i follows a mixture distribution).</p>
<p><strong>Solution:</strong></p>
<p>Obesrved data: <span class="math inline">\(y_1,\cdots,y_n\)</span>,let<span class="math inline">\(n_0\)</span>is true observation data,thus the right censorship data<span class="math inline">\(y_i=\tau,i=n_0,\cdots,n\)</span>.<br />
Complete data: <span class="math inline">\(t_1,\cdots,t_n\)</span><br />
(1)The observed data MLE<br />
<span class="math display">\[
L_{observed}(\lambda)=P(T&gt;\tau)^{n-n_0}\cdot\lambda^{-n_0}e^{-\frac{1}{\lambda}\sum_{i=1}^{n_0}y_i}\\
=e^{-\frac{\tau(n-n_0)}{\lambda}}\cdot\lambda^{-n_0}e^{-\frac{1}{\lambda}\sum_{i=1}^{n_0}y_i},\\
lnL_{observed}(\lambda)=-\frac{\tau(n-n_0)}{\lambda}-n_0ln\lambda-\frac{1}{\lambda}\sum_{i=1}^{n_0}y_i,\\
\frac{\partial lnL_{observed}(\lambda)}{\partial \lambda}=\frac{\tau(n-n_0)}{\lambda^2}-\frac{n_0}{\lambda}+\frac{1}{\lambda^2}\sum_{i=1}^{n_0}y_i=0,\\
\hat\lambda=\frac{\tau(n-n_0)+\sum_{i=1}^{n_0}y_i}{n_0}.
\]</span><br />
So we get the observed data MLE <span class="math inline">\(\hat\lambda\)</span> which <span class="math inline">\(\tau=1,n=10,n_0=7,\)</span> and true observation data<span class="math inline">\(0.54,0.48,0.33,0.43,0.91,0.21,0.85\)</span>:<br />
</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a>tau=<span class="dv">1</span></span>
<span id="cb117-2"><a href="#cb117-2"></a>n=<span class="dv">10</span></span>
<span id="cb117-3"><a href="#cb117-3"></a>n_<span class="dv">0</span>=<span class="dv">7</span></span>
<span id="cb117-4"><a href="#cb117-4"></a>y=<span class="kw">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="fl">0.91</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>)</span>
<span id="cb117-5"><a href="#cb117-5"></a>lambda.hat &lt;-<span class="st"> </span>(tau<span class="op">*</span>(n<span class="op">-</span>n_<span class="dv">0</span>)<span class="op">+</span><span class="kw">sum</span>(y))<span class="op">/</span>n_<span class="dv">0</span></span>
<span id="cb117-6"><a href="#cb117-6"></a>lambda.hat</span></code></pre></div>
<pre><code>## [1] 0.9642857</code></pre>
<p>(2)Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span><br />
<span class="math display">\[
L_{complete}(\lambda)=\lambda^{-n}e^{-\frac{1}{\lambda}\sum_{i=1}^{n}t_i},\\
lnL_{complete}(\lambda)=-nln\lambda-\frac{1}{\lambda}\sum_{i=1}^{n}t_i
\]</span><br />
(i)E step:<br />
<span class="math display">\[
Q(\lambda,\lambda^{(i)})=E{[lnL_{complete}(\lambda)|Y,\lambda^{(i)}]}\\
=E{[-nln\lambda-\frac{1}{\lambda}\sum_{i=1}^{n}t_i|Y,\lambda^{(i)}]}\\
=-nln\lambda-\frac{1}{\lambda}\sum_{i=1}^{n}E[t_i|y_i,\lambda^{(i)}]\\
=-nln\lambda-\frac{1}{\lambda}[\sum_{i=1}^{n_0}y_i+\sum_{i=n_0+1}^{n}(y_i+\lambda^{(i)})]\\
=-nln\lambda-\frac{1}{\lambda}\sum_{i=1}^{n}y_i-\frac{(n-n_0)\lambda^{(i)}}{\lambda}
\]</span><br />
(ii)M step(maximize the <span class="math inline">\(Q(\lambda,\lambda^{(i)})\)</span> of E step):<br />
<span class="math display">\[
\frac{\partial Q(\lambda,\lambda^{(i)})}{\partial \lambda}=-\frac{n}{\lambda}+\frac{\sum_{i=1}^{n}y_i+(n-n_0)\lambda^{(i)}}{\lambda^2}=0,\\
\lambda^{(i+1)}=\frac{1}{n}\sum_{i=1}^{n}y_i+\frac{n-n_0}{n}\lambda^{(i)}
\]</span><br />
So <span class="math display">\[
|\lambda^{(i+1)}-\lambda^{(i)}|=|(\frac{1}{n}\sum_{i=1}^{n}y_i+\frac{n-n_0}{n}\lambda^{(i)})-(\frac{1}{n}\sum_{i=1}^{n}y_i+\frac{n-n_0}{n}\lambda^{(i-1)})|\\
=\frac{n-n_0}{n}|\lambda^{(i)}-\lambda^{(i-1)}|\\
\Rightarrow |\lambda^{(n+1)}-\lambda^{(n)}|=(\frac{n-n_0}{n})^n|\lambda^{(1)}-\lambda^{(0)}|\overset{n\rightarrow\infty}{\rightarrow}0\\
\Rightarrow \lambda^{(n)} converge\\
\Rightarrow \tilde{\lambda}=\frac{1}{n}\sum_{i=1}^{n}y_i+\frac{n-n_0}{n}\tilde{\lambda}\\
\Rightarrow \tilde{\lambda}=\frac{1}{n_0}\sum_{i=1}^{n}y_i
\]</span><br />
Compare the estimation of <span class="math inline">\(\lambda\)</span> by using the E-M algorithm with the observed data MLE:<br />
<span class="math display">\[
\tilde{\lambda}=\frac{1}{n_0}\sum_{i=1}^{n}y_i\\
\hat\lambda=\frac{\tau(n-n_0)+\sum_{i=1}^{n_0}y_i}{n_0}
\]</span><br />
When <span class="math inline">\(\tau=1,n=10,n_0=7,\)</span>,the EM algorithm <span class="math inline">\(\tilde{\lambda}=\frac{1}{n_0}\sum_{i=1}^{n}y_i\)</span> converges to the observed data MLE <span class="math inline">\(\hat\lambda=\frac{\tau(n-n_0)+\sum_{i=1}^{n_0}y_i}{n_0}\)</span>!<br />
</p>
<p>Use EM algorithm to solve MLE of <span class="math inline">\(\lambda\)</span>.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb119-2"><a href="#cb119-2"></a>lambda0 &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb119-3"><a href="#cb119-3"></a></span>
<span id="cb119-4"><a href="#cb119-4"></a>EMlambda &lt;-<span class="st"> </span><span class="cf">function</span>(y, lambda){</span>
<span id="cb119-5"><a href="#cb119-5"></a>  N &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb119-6"><a href="#cb119-6"></a>  tol &lt;-<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span></span>
<span id="cb119-7"><a href="#cb119-7"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(y)</span>
<span id="cb119-8"><a href="#cb119-8"></a>  nt &lt;-<span class="st"> </span><span class="kw">sum</span>(y<span class="op">==</span><span class="dv">1</span>)</span>
<span id="cb119-9"><a href="#cb119-9"></a>  </span>
<span id="cb119-10"><a href="#cb119-10"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb119-11"><a href="#cb119-11"></a>    total &lt;-<span class="st"> </span><span class="kw">sum</span>(y)</span>
<span id="cb119-12"><a href="#cb119-12"></a>    lambda_old &lt;-<span class="st"> </span>lambda</span>
<span id="cb119-13"><a href="#cb119-13"></a>    lambda &lt;-<span class="st"> </span>(total <span class="op">+</span><span class="st"> </span>nt<span class="op">*</span>lambda_old) <span class="op">/</span><span class="st"> </span>n</span>
<span id="cb119-14"><a href="#cb119-14"></a>    </span>
<span id="cb119-15"><a href="#cb119-15"></a>    <span class="cf">if</span>(<span class="kw">abs</span>(lambda <span class="op">-</span><span class="st"> </span>lambda_old)<span class="op">/</span>lambda_old <span class="op">&lt;</span>tol) <span class="cf">break</span></span>
<span id="cb119-16"><a href="#cb119-16"></a>  }</span>
<span id="cb119-17"><a href="#cb119-17"></a>  </span>
<span id="cb119-18"><a href="#cb119-18"></a>  <span class="kw">return</span>(lambda)</span>
<span id="cb119-19"><a href="#cb119-19"></a>}</span>
<span id="cb119-20"><a href="#cb119-20"></a></span>
<span id="cb119-21"><a href="#cb119-21"></a><span class="kw">EMlambda</span>(y, lambda0)</span></code></pre></div>
<pre><code>## [1] 0.9642857</code></pre>
<p>Using EM algorithm we get the estimation of <span class="math inline">\(\lambda\)</span> is equal 0.9642857.<br />
</p>
</div>
<div id="title-a-21010-2021-11-25" class="section level2">
<h2>title: “A-21010-2021-11-25”</h2>
</div>
<div id="exercise-1-and-5-page-204-advanced-r" class="section level2">
<h2>Exercise 1 and 5 (page 204, Advanced R)</h2>
</div>
<div id="exercise-1-and-7-page-214-advanced-r" class="section level2">
<h2>Exercise 1 and 7 (page 214, Advanced R)</h2>
</div>
<div id="exercise-1-page-204-advanced-r" class="section level2">
<h2>Exercise 1 (page 204, Advanced R)</h2>
<p>Why are the following two invocations of lapply() equivalent?<br />
<span class="math display">\[
trims &lt;- c(0, 0.1, 0.2, 0.5)\\
x &lt;- rcauchy(100)\\
lapply(trims, function(trim) mean(x, trim = trim))\\
lapply(trims, mean, x = x)
\]</span><br />
</p>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a>trims &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb121-2"><a href="#cb121-2"></a>x &lt;-<span class="st"> </span><span class="kw">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb121-3"><a href="#cb121-3"></a><span class="kw">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="kw">mean</span>(x, <span class="dt">trim =</span> trim))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 134.4659
## 
## [[2]]
## [1] 0.1417262
## 
## [[3]]
## [1] 0.0435676
## 
## [[4]]
## [1] 0.05072846</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a><span class="kw">lapply</span>(trims, mean, <span class="dt">x =</span> x)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 134.4659
## 
## [[2]]
## [1] 0.1417262
## 
## [[3]]
## [1] 0.0435676
## 
## [[4]]
## [1] 0.05072846</code></pre>
<p>Reason of the two invocations of lapply() equivalent:<br />
In the first statement each element of “trims” is explicitly supplied to “mean()”’s second argument.<br />
In the latter statement this happens via positional matching, since “mean()”’s first argument is supplied via name in “lapply()”’s third argument.</p>
</div>
<div id="exercise-5-page-204-advanced-r" class="section level2">
<h2>Exercise 5 (page 204, Advanced R)</h2>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below. <span class="math display">\[
rsq &lt;- function(mod) summary(mod)$r.squared
\]</span><br />
</p>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a>rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</span></code></pre></div>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a><span class="co"># 3</span></span>
<span id="cb126-2"><a href="#cb126-2"></a><span class="kw">data</span>(mtcars)</span>
<span id="cb126-3"><a href="#cb126-3"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb126-4"><a href="#cb126-4"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb126-5"><a href="#cb126-5"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb126-6"><a href="#cb126-6"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb126-7"><a href="#cb126-7"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb126-8"><a href="#cb126-8"></a>)</span>
<span id="cb126-9"><a href="#cb126-9"></a>models &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(formula) <span class="kw">lm</span>(formula, mtcars))</span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a><span class="kw">lapply</span>(models, <span class="cf">function</span>(model) <span class="kw">rsq</span>(model))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a><span class="co"># 4</span></span>
<span id="cb129-2"><a href="#cb129-2"></a><span class="kw">data</span>(<span class="st">&quot;mtcars&quot;</span>)</span>
<span id="cb129-3"><a href="#cb129-3"></a>bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb129-4"><a href="#cb129-4"></a>  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</span>
<span id="cb129-5"><a href="#cb129-5"></a>  mtcars[rows, ]</span>
<span id="cb129-6"><a href="#cb129-6"></a>})</span></code></pre></div>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a><span class="co"># for loop</span></span>
<span id="cb130-2"><a href="#cb130-2"></a>models_loop &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb130-3"><a href="#cb130-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</span>
<span id="cb130-4"><a href="#cb130-4"></a>  model &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp, <span class="dt">data =</span> bootstraps[[i]])</span>
<span id="cb130-5"><a href="#cb130-5"></a>  models_loop &lt;-<span class="st"> </span><span class="kw">c</span>(models_loop, <span class="kw">list</span>(model))</span>
<span id="cb130-6"><a href="#cb130-6"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a><span class="co"># R^2</span></span>
<span id="cb131-2"><a href="#cb131-2"></a><span class="kw">lapply</span>(models_loop, <span class="cf">function</span>(model) <span class="kw">rsq</span>(model))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7526902
## 
## [[2]]
## [1] 0.6961595
## 
## [[3]]
## [1] 0.6153573
## 
## [[4]]
## [1] 0.5598672
## 
## [[5]]
## [1] 0.6122787
## 
## [[6]]
## [1] 0.7464705
## 
## [[7]]
## [1] 0.7312463
## 
## [[8]]
## [1] 0.8065431
## 
## [[9]]
## [1] 0.7916834
## 
## [[10]]
## [1] 0.635318</code></pre>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a><span class="co"># lapply</span></span>
<span id="cb133-2"><a href="#cb133-2"></a>models_lapply &lt;-<span class="st"> </span><span class="kw">lapply</span>(bootstraps, <span class="cf">function</span>(data) <span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp, data))</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a><span class="co"># R^2</span></span>
<span id="cb134-2"><a href="#cb134-2"></a><span class="kw">lapply</span>(models_lapply, <span class="cf">function</span>(model) <span class="kw">rsq</span>(model))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7526902
## 
## [[2]]
## [1] 0.6961595
## 
## [[3]]
## [1] 0.6153573
## 
## [[4]]
## [1] 0.5598672
## 
## [[5]]
## [1] 0.6122787
## 
## [[6]]
## [1] 0.7464705
## 
## [[7]]
## [1] 0.7312463
## 
## [[8]]
## [1] 0.8065431
## 
## [[9]]
## [1] 0.7916834
## 
## [[10]]
## [1] 0.635318</code></pre>
<p><br />
</p>
</div>
<div id="exercise-1-page-214-advanced-r" class="section level2">
<h2>Exercise 1 (page 214, Advanced R)</h2>
<p>Use vapply() to:<br />
a) Compute the standard deviation of every column in a numeric data frame.<br />
b) Compute the standard deviation of every numeric column in a mixed data frame. (Hint: you’ll need to use vapply() twice.)<br />
</p>
<p><strong>Solution:</strong></p>
<p>(a)Every column in a numeric data frame.<br />
</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a>cars <span class="co">##  a numeric data.frame.</span></span></code></pre></div>
<pre><code>##    speed dist
## 1      4    2
## 2      4   10
## 3      7    4
## 4      7   22
## 5      8   16
## 6      9   10
## 7     10   18
## 8     10   26
## 9     10   34
## 10    11   17
## 11    11   28
## 12    12   14
## 13    12   20
## 14    12   24
## 15    12   28
## 16    13   26
## 17    13   34
## 18    13   34
## 19    13   46
## 20    14   26
## 21    14   36
## 22    14   60
## 23    14   80
## 24    15   20
## 25    15   26
## 26    15   54
## 27    16   32
## 28    16   40
## 29    17   32
## 30    17   40
## 31    17   50
## 32    18   42
## 33    18   56
## 34    18   76
## 35    18   84
## 36    19   36
## 37    19   46
## 38    19   68
## 39    20   32
## 40    20   48
## 41    20   52
## 42    20   56
## 43    20   64
## 44    22   66
## 45    23   54
## 46    24   70
## 47    24   92
## 48    24   93
## 49    24  120
## 50    25   85</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1"></a><span class="kw">vapply</span>(cars, sd, <span class="kw">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##     speed      dist 
##  5.287644 25.769377</code></pre>
<p><br />
(2)Every numeric column in a mixed data frame.<br />
</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1"></a><span class="co">## a mixed data.frame&quot;mtcars&quot;.</span></span>
<span id="cb140-2"><a href="#cb140-2"></a><span class="kw">vapply</span>(mtcars[<span class="kw">vapply</span>(mtcars, is.numeric, <span class="kw">logical</span>(<span class="dv">1</span>))],sd, <span class="kw">numeric</span>(<span class="dv">1</span>)) <span class="co">## use vapply() twice.</span></span></code></pre></div>
<pre><code>##         mpg         cyl        disp          hp        drat          wt 
##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
##        qsec          vs          am        gear        carb 
##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
</div>
<div id="exercise-7-page-214-advanced-r" class="section level2">
<h2>Exercise 7 (page 214, Advanced R)</h2>
<p>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()?Why or why not?<br />
</p>
<p><strong>Solution:</strong><br />
(1)Notice that “mc.cores” &gt; 1 is not supported on Windows.An alternative to mcsapply for Windows is parallel::parSapply.<br />
(2)mcvapply(),unlike sapply, vapply is directed to Internal(vapply(X, FUN, FUN.VALUE, USE.NAMES)), which performs a call to an internal code built in the R interpreter, so it’s not easy to implement mcvapply() the parallel version of vapply.<br />
(3)It can be seen from the results that mcsapply() the multicore version of sapply() is significantly faster than using the sapply function alone.<br />
But I don’t think you can implement mcvapply() (a parallel version of vapply()) by R package(parallel),because vapply() directly output non-list!</p>
</div>
<div id="title-a-21010-2021-12-02" class="section level2">
<h2>title: “A-21010-2021-12-02”</h2>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>(1)Write an Rcpp function for Exercise 9.8 (page 278, Statistical Computing with R).<br />
(2)Compare the corresponding generated random numbers with pure R language using the function “qqplot”.<br />
(3)Campare the computation time of the two functions with the function “microbenchmark”.<br />
(4)Comments your results.<br />
</p>
<p><strong>Exercise 9.8:</strong> This example appears in [40]. Consider the bivariate density<br />
<span class="math display">\[
f(x,y)\propto \binom{n}{x}y^{x+a-1}(1-y)^{n-x+b-1},x=0,1,\cdots,n,0\leq y\leq 1.
\]</span><br />
It can be shown (see e.g. [23]) that for fixed a, b, n, the conditional distributions are Binomial(n, y) and Beta(x + a, n − x + b). Use the Gibbs sampler to generate a chain with target joint density f(x, y).<br />
</p>
<p><strong>Solution:</strong><br />
</p>
<p>(1)Write an Rcpp function for Exercise 9.8 (page 278, Statistical Computing with R).<br />
</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1"></a><span class="kw">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Rcpp&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1"></a><span class="kw">cppFunction</span>(<span class="st">&#39;</span></span>
<span id="cb144-2"><a href="#cb144-2"></a><span class="st">NumericMatrix gibbsc(int N,int burn,int a,int b,int n){</span></span>
<span id="cb144-3"><a href="#cb144-3"></a><span class="st">  NumericMatrix X(N,2);</span></span>
<span id="cb144-4"><a href="#cb144-4"></a><span class="st">  NumericMatrix XX(N-burn,2);</span></span>
<span id="cb144-5"><a href="#cb144-5"></a><span class="st">  float x,y;</span></span>
<span id="cb144-6"><a href="#cb144-6"></a><span class="st">  X(0,0)=1;</span></span>
<span id="cb144-7"><a href="#cb144-7"></a><span class="st">  X(0,1)=0.5;</span></span>
<span id="cb144-8"><a href="#cb144-8"></a><span class="st">  for(int i=1;i&lt;N;i++){</span></span>
<span id="cb144-9"><a href="#cb144-9"></a><span class="st">    y=X(i-1,1);</span></span>
<span id="cb144-10"><a href="#cb144-10"></a><span class="st">    X(i,0)=rbinom(1,n,y)[0];</span></span>
<span id="cb144-11"><a href="#cb144-11"></a><span class="st">    x=X(i,0);</span></span>
<span id="cb144-12"><a href="#cb144-12"></a><span class="st">    X(i,1)=rbeta(1,x+a,n-x+b)[0];</span></span>
<span id="cb144-13"><a href="#cb144-13"></a><span class="st">  }</span></span>
<span id="cb144-14"><a href="#cb144-14"></a><span class="st">  for(int k=0;k&lt;N-burn;k++){</span></span>
<span id="cb144-15"><a href="#cb144-15"></a><span class="st">    XX(k,0)=X(k+burn,0);</span></span>
<span id="cb144-16"><a href="#cb144-16"></a><span class="st">    XX(k,1)=X(k+burn,1);</span></span>
<span id="cb144-17"><a href="#cb144-17"></a><span class="st">  }</span></span>
<span id="cb144-18"><a href="#cb144-18"></a><span class="st">  return XX;</span></span>
<span id="cb144-19"><a href="#cb144-19"></a><span class="st">}</span></span>
<span id="cb144-20"><a href="#cb144-20"></a><span class="st">&#39;</span>)</span>
<span id="cb144-21"><a href="#cb144-21"></a>res1&lt;-<span class="kw">gibbsc</span>(<span class="dv">5000</span>,<span class="dv">1000</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">10</span>)</span></code></pre></div>
<p><br />
(2)Compare the corresponding generated random numbers with pure R language using the function “qqplot”.<br />
</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a>gibbsr&lt;-<span class="cf">function</span>(N,burn,<span class="dt">a=</span><span class="dv">2</span>,<span class="dt">b=</span><span class="dv">2</span>,<span class="dt">n=</span><span class="dv">10</span>){</span>
<span id="cb145-2"><a href="#cb145-2"></a>  X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb145-3"><a href="#cb145-3"></a>  <span class="co">###### generate the chain #####</span></span>
<span id="cb145-4"><a href="#cb145-4"></a>  X[<span class="dv">1</span>, ] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">.5</span>) <span class="co">#initialize</span></span>
<span id="cb145-5"><a href="#cb145-5"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb145-6"><a href="#cb145-6"></a>    y &lt;-<span class="st"> </span>X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb145-7"><a href="#cb145-7"></a>    X[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb145-8"><a href="#cb145-8"></a>    x &lt;-<span class="st"> </span>X[i, <span class="dv">1</span>]</span>
<span id="cb145-9"><a href="#cb145-9"></a>    X[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>,x<span class="op">+</span>a,n<span class="op">-</span>x<span class="op">+</span>b)</span>
<span id="cb145-10"><a href="#cb145-10"></a>    }</span>
<span id="cb145-11"><a href="#cb145-11"></a>  b &lt;-<span class="st"> </span>burn <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb145-12"><a href="#cb145-12"></a>  <span class="kw">return</span>(X[b<span class="op">:</span>N, ])</span>
<span id="cb145-13"><a href="#cb145-13"></a>}</span>
<span id="cb145-14"><a href="#cb145-14"></a>res2&lt;-<span class="kw">gibbsr</span>(<span class="dv">5000</span>,<span class="dv">1000</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">10</span>)</span></code></pre></div>
<p><br />
</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1"></a>a &lt;-<span class="st"> </span><span class="kw">ppoints</span>(<span class="dv">50</span>)</span>
<span id="cb146-2"><a href="#cb146-2"></a>Q1x &lt;-<span class="st"> </span><span class="kw">quantile</span>(res1[,<span class="dv">1</span>], a)   <span class="co">#quantiles of Cauchy</span></span>
<span id="cb146-3"><a href="#cb146-3"></a>Q2x &lt;-<span class="st"> </span><span class="kw">quantile</span>(res2[,<span class="dv">1</span>], a)</span>
<span id="cb146-4"><a href="#cb146-4"></a>Q1y &lt;-<span class="st"> </span><span class="kw">quantile</span>(res1[,<span class="dv">2</span>], a)   <span class="co">#quantiles of Cauchy</span></span>
<span id="cb146-5"><a href="#cb146-5"></a>Q2y &lt;-<span class="st"> </span><span class="kw">quantile</span>(res2[,<span class="dv">2</span>], a)</span>
<span id="cb146-6"><a href="#cb146-6"></a><span class="kw">qqplot</span>(Q1x, Q2x, <span class="dt">main=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb146-7"><a href="#cb146-7"></a>        <span class="dt">xlab=</span><span class="st">&quot;Rcpp Quantiles of x&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R Quantiles of x&quot;</span>)</span>
<span id="cb146-8"><a href="#cb146-8"></a>    <span class="kw">abline</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a><span class="kw">qqplot</span>(Q1y, Q2y, <span class="dt">main=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb147-2"><a href="#cb147-2"></a>        <span class="dt">xlab=</span><span class="st">&quot;Rcpp Quantiles of y&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R Quantiles of y&quot;</span>)</span>
<span id="cb147-3"><a href="#cb147-3"></a>    <span class="kw">abline</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAclBMVEUAAAAAADoAAGYAAP8AOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmADpmkJBmtrZmtv+QOgCQZgCQtpCQ27aQ2/+2ZgC2Zjq225C2/7a2///bkDrbkJDbtmbb25Db/7bb////tmb/25D//7b//9v////A2uixAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALcklEQVR4nO2di3bjthVF4RlJk0aaxm5qph0mjWmZ//+LJQASfPPgTcpzzlqTUPIlAG8DF68LUtTUpsTeBTi6CAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgCIDEg+ir1+dAd1v4hwBUHgSidXQqb9+9QBU12Vz7zU0+8D7k0sWUPKxLujYMJjR0QGJuq0+noA0oi8/QgpwaImu+vgBqho6z/XHy+nNvwDHlqk+HoAaLy00mcq/Ch0cUN+83AHdb0+v4SU4LiDVtzd4ZC9WB/ig0GLETS6ejHfuP1vfGLkch5SY9u0ENFbbvAZfWN8ZuSBxk4uj1vvUAYDut+f79wg++pCAzNRCjL60vlvqfrt+WkCm8xqVzbWJlf1EN2AcfTxAXec+K5jHOOgz1qB+4h4OKI6OBajv3Gfl8gH0fmkqZOBw+kiATOuauB/9Q+tUzFWlFjrKZrYaUqiQm+NqsfMa/NQ6mVYfL3ohqPSfyrvkm1itcxar83afyaquOgFTeZd806pfF1toXZ2FdVJan6kGbTjn3sQ6rU4hPqgfRXncHFuweSkj69T6y0/Si/XOeevP9fOOgyxXnX9WQIOxDzC0TjG0SEmTc89+a+wztrROMqp2BWTjnI2tdaJBRUqdnGPels1LG1unGlX7ARJmVdWqDF77Yle5LBQ0TtwPUNd5CcsieAAqTm/vl3NdnJ0L55NvXJnqYz1U9ZuLVc0w+hHnYq7Vp/YFVDRwyscD5Fx9ar8mdr7fTm/329mpcL75RlM383KpPrWnk24mYh8v5y1rWcXklG11xpYd0KBvd8o7TTev+Hx77RePwpILl6k+tes6QhJAciDQ9nJrq0ZZAYnNVWdwr4dh08ZOb8VGBJ6sN+262lpflxNQG40pXN2PvtndsHp6LaWT3iAka095llf716Chc/ZYp/NbcpW/9lY3f799+aGqULXmpbMBEitbyvb3uxrK9iMBbQ8UK72weg7ON0z+ztmk4GzY1aDi+Iv2YhBO55uhtw96gI1DYWYWAXsEnr2Y9aL9mqfKAEj0M9OQVKIbbqeSb9snvHXpZKIb7pLcQgZd5x6Y02cFZLtpgRNyM1TuxyLC7OMF2KQFNI4FD0squqFU2R0FqtbOBKUEFDz2GSUW3bDu4xvqXaYakbxzl1p0w3q0yJF/str37VHycPZBV+OG1n3QjjUoYGFjJcHohlJmmJ3ZB5nWFcX96CSdDbsw4M3JalfNVudrSQCZLeWIA1F/QMfb1fDZtMCJOhoW/TjoYId6EzQvlayz4UEj7Qd4oqb9WaYaCbxPm7C7IZxGRM3XLjUzdI5fM90NiyAyrvlaJZbE+7RpOxtubmfEz9ciqUTep03d2XB1szRNvjglm2DegOSdDcGufOx8kfpHJCQanLsbVmHL9Y75gmT6zivR7M6niR3nSGbfeSVbHXjkcVDKzqvPJLphruS6sU8q79xl427YtbF9m5hI7Z27fNwNi9Nbea7fL3sehzJ4km+x+Q0UKxndsePe/GDsk3z/yNlQDhTff/mh/mXId0mZWpeSz0DxqpY89gIk0o99Rtm5G8qlxOK6VxPL2Lp0fh6GxVn2ZGFzes9fbnASJQueRxsHiQxD52mW0Q0TJtcPnXOF8D3WXKyP5c14qty7BoUd9vEAFHvL1DZbb8PM58XMKdOseEIAZT0vtlP1qUMA5dxZ7c8x5ebjD2j7vJh81JmazEaIchXDman9bZHk34ttDaTLp9eWYDigHk/+6lMnGgfp+CD1NOVQQMOh8x580kaYyZWjMEDGOcffrLaUz2xeqED7QRjZVOZHxTkEkNi9+tQegNoA1nJzJN1hWZ/TWuTbnjLdy/mYUrgZmgNg5ebLI7oYvI8XT0BCiMGmjm0hE8gRkNlWVccy0+Ur2mXDHZ1PXxIXQ7MxX57+SjhQFLXV47NyyBeQ7VTDx0kLl+f7pJZvE/OcrNps+wj4bMOc8nbS6rkBKfJ1f+VHUvl382EhHqv5RjyoE0W+A0XQhXkfh1p4qvy+SrMm7X0cKsYp07hKOFlVcjnMYv1sw5xKOlmtnY5DrT82fU8dpwb1r/w4Ep9kPsjpOJRqU7utOm8rANCfsY5Dyesjti4lj3GQ7rtX5+nO+XZ8Dte6lHxG0vKxJlW841AHWddYkc9crOmkyigP3NZEZi9kOpScZ/NXSekfwa9aFeafCRc7pryWO4rg16zWZjKqFzYOy8cTUNBiYpfcsPM6rvwAnWPkKx6Bz56A3N4UvJd2BPQQfNwB9YumYQPFB2hdSmnmYlht5/UA2glQeG7ZTCxFQNlSipQbAR3FxFIElC2lSLkR0FFMLEVA2VKKlNvPDegBRUBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQElAVQNXgljgq1ngdJVJO35izECYxM5JsWz9upmBPIQcoBSEZndWcdPl6ai/mhtKGJ+jyP8huZyGdlzQ9oj0zkCeQIz4bMAEgHx7b72voZadPDQiOTevHY2shEf9hMRZ/PCd9NzwBogcn0DXdTk/L0rymgkcnykZuRySMBUr/NKPR8+mjmiUnzceaDRibVl//e5p5snMrjNDFdXcYe5rplIpvKDNDIpJQhFrPH804ymvp9P+0BqFr00b3J4psEx4CeZpVylop+q3CMoMLUmjaxhTD9kYn6sN3EtJ+ZPhRznMpib+Cu/E66XBgFjUzKNkDled1EQ5i66rHJrGH7KXc3v3ymcdrNL9SgkYmOiJs2sYXxROADter8A8UVrzAdKC6MpMejwObH84dojEwexwepRiOLLbudtv3Mav7ARGlhqjEyqRYnLCOTYtHEVZysAhEQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBJQfUPWHZZpe8Wtq1n5g8q9COwWNlV1TG2JivswA6y/9ZRAvqZ1xuB2R0YCAg9Vy/GMoFaBZQOFc5DA1bkQOg8BhypVyAdDyLDH451+/ffr+oBmAupMzfXL3O9Ln9HQsdana//XZrLmR8/envromVbcuV35oKquNi5FeKtwqnKs/+5c9ag/Trt65N6Z9VmzMXUiagrvrywwAqzF0yQP/ptfM/8p/8XjZIVeW6VOT/ZQh+V4MqFQ4bUJtyASpVwXUd0W6mPL2ZC/ltH76rOcjfUb5bWQFQtzYXA0A6tQbAMMxOR511KdTtK6xD3vSQrRd77r1LGz749Gou6noZkPooxLNpcwNA2l5B6wnpFFuSSk0dDHo7c54a9H5p/mP+km24bgPo2yASdbGJyac4/+eyDMgEw6q/wZB9a9ilVoR0aJmamIqNNjVoEVDvpE9vHQ91x/sKoPHxqZbyrAbdv//7e0gocC4fVGj/rL7SrqfofFAXr1kqf3r6X/Nl53KUe6mWm9i4I28/zXyQfMZxSAvLBuh+a4op+53m8/ulPWdiLrQKRUioCN/TW3P1rCuPuA4AXUe9mASvqlJXn6a92HLguoOyjYNUOdtx0OWfl9ZrtxetWrfScJKPBv1N+6Cn12LgtYvJOEhXscEMpY0P7gEle1tROpmx8sqg+Y/wMzrD3H4NaWGHBBRXZdik7LMDer8EuWiuB0EREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAf0fgSBLqIUTlJwAAAAASUVORK5CYII=" /><!-- --><br />
(3)Campare the computation time of the two functions with the function “microbenchmark”.<br />
</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1"></a><span class="kw">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1"></a>ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">Rcpp=</span><span class="kw">gibbsc</span>(<span class="dv">5000</span>,<span class="dv">1000</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">10</span>),<span class="dt">R=</span><span class="kw">gibbsr</span>(<span class="dv">5000</span>,<span class="dv">1000</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">10</span>))</span>
<span id="cb150-2"><a href="#cb150-2"></a><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr       lq   median       uq
## 1 Rcpp  1.33585  1.40635  1.74985
## 2    R 16.43645 17.32000 18.70125</code></pre>
<p><br />
(4)Comments your results.<br />
</p>
<p><strong>Comments:</strong><br />
(i)We can see that the qq plot is close to y = x,which means the samples generated by two samplers are quite similar.<br />
(ii)By computing the computation time,the time of sampler using R is much more than that of sampler using Rcpp,so Rcpp gives higher performance computation!<br />
</p>
</div>
<div id="the-all-answers-of-my-homewrk-of-statistical-computing-class-is-above." class="section level2">
<h2>The all answers of my homewrk of “Statistical Computing” class is above.</h2>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
